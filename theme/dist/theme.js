"use strict";(()=>{var te=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Lt={identifier:"en-US",UI_OK:"OK",UI_CANCEL:"Cancel",UI_APPLY:"Apply",UI_RESET:"Reset",UI_AUTO:"Auto",UI_CUSTOM:"Custom",UI_CLICK_HERE:"click here",MAIN_MSG_ERROR_LOAD_FAIL:"Theme loading failed. Please refresh the page to try again. Please make sure you have a compatible version of Spotify installed.",MAIN_MSG_ERROR_INIT:"An error occurred during initialization. Please check the console for more information.",MAIN_MSG_ERROR_INCOMPAT_EXT:"Incompatible extension %s detected! Some features of WMPotify will be disabled.",TAB_NOW_PLAYING:"Now Playing",TAB_LIBRARY:"Library",PB_BTN_MINI_MODE:"Mini mode",PB_BTN_FULLSCREEN:"Full screen",LIBX_SIDEBAR_ROOT:"Library",LIBX_HEADER_ROOT:"Music",QUEUE_CURRENT_PLAYLIST_PLACEHOLDER:"Now Playing",MENU_CONF:"WMPotify Properties",CONF_COLOR_TITLE:"Color Chooser",CONF_COLOR_HUE:"Hue",CONF_COLOR_SAT:"Saturation",CONF_COLOR_TINTPB:"Apply color to the now playing bar buttons",CONF_GENERAL_TITLE:"General",CONF_GENERAL_STYLE:"Style",CONF_GENERAL_TITLE_STYLE:"Title style",CONF_GENERAL_TITLE_STYLE_NATIVE:"Native",CONF_GENERAL_TITLE_STYLE_CUSTOM:"Custom",CONF_GENERAL_TITLE_STYLE_KEEPMENU:"Keep Menu",CONF_GENERAL_APPLY:"Apply (reload required)",CONF_GENERAL_FONT:"UI font",CONF_GENERAL_CUSTOM_FONT_DLG_TITLE:"Set custom font",CONF_GENERAL_CUSTOM_FONT_MSG:"Enter a valid CSS font-family name",CONF_GENERAL_TOPMOST:"Always on top",CONF_GENERAL_TOPMOST_ALWAYS:"Always",CONF_GENERAL_TOPMOST_MINIMODE:"In mini mode",CONF_GENERAL_TOPMOST_NEVER:"Never",CONF_GENERAL_BACKDROP:"Backdrop",CONF_GENERAL_BACKDROP_NONE:"None (restart required)",CONF_GENERAL_BACKDROP_ACRYLIC:"Acrylic",CONF_GENERAL_BACKDROP_TABBED:"Tabbed",CONF_GENERAL_SHOW_LIBX:"Show Your Library X on the left sidebar",CONF_GENERAL_LOCK_TITLE:"Use static window title",CONF_GENERAL_WH_MESSAGE:'Some options require <a href="https://windhawk.net/mods/cef-titlebar-enabler-universal">CEF/Spotify Tweaks Windhawk mod</a> to work or look good.',CONF_SPEED_TITLE:"Play speed settings",CONF_SPEED_SLOW:"Slow",CONF_SPEED_NORMAL:"Normal",CONF_SPEED_FAST:"Fast",CONF_SPEED_CURRENT_LABEL:"Play speed",CONF_SPEED_CUSTOM_DLG_TITLE:"Set playback speed",CONF_SPEED_CUSTOM_MSG:"Enter a playback speed (0.5 - 5.0)",CONF_SPEED_NO_CONNECT_MSG:"Cannot change playback speed while playing from another device",CONF_ABOUT_TITLE:"About",CONF_ABOUT_DESC:"A Windows Media Player 11 inspired Spicetify theme for Spotify",CONF_ABOUT_VERSION:"Version",CONF_ABOUT_CTEWH_VERSION:"CEF/Spotify Tweaks Windhawk mod %s available",CONF_ABOUT_AUTHOR:"Made by Ingan121",WMPVIS_INSTALL_TITLE:"Install WMPotify NowPlaying?",WMPVIS_INSTALL_DESC:"WMPotify NowPlaying features WMP-like visualization screen and lyrics overlaid on top of it. We recommend installing it for the best experience with WMPotify.",WMPVIS_INSTALL_STEPS:"To install it, please follow these steps:",WMPVIS_INSTALL_STEP1:"Copy the following code:",WMPVIS_INSTALL_STEP2:"Press Win+R to open the Run dialog",WMPVIS_INSTALL_STEP2_UNIX:"Open a terminal window",WMPVIS_INSTALL_STEP3:"Paste the code and press Enter",WMPVIS_INSTALL_MORE_INFO:"Or %s for more information, including manual installation instructions.",WMPVIS_INSTALL_HIDE:"If you don't want to install it, %s to hide this button.",WMPVIS_INSTALL_CODE_COPY:"Code copied to clipboard!"},tt=Lt;var vt={identifier:"ko-KR",UI_OK:"\uD655\uC778",UI_CANCEL:"\uCDE8\uC18C",UI_APPLY:"\uC801\uC6A9",UI_RESET:"\uC7AC\uC124\uC815",UI_AUTO:"\uC790\uB3D9",UI_CUSTOM:"\uC0AC\uC6A9\uC790 \uC9C0\uC815",UI_CLICK_HERE:"\uC5EC\uAE30\uB97C \uD074\uB9AD",MAIN_MSG_ERROR_LOAD_FAIL:"\uD14C\uB9C8 \uB85C\uB4DC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4. \uD398\uC774\uC9C0\uB97C \uC0C8\uB85C \uACE0\uCCD0 \uB2E4\uC2DC \uC2DC\uB3C4\uD558\uC2ED\uC2DC\uC624. \uD638\uD658 \uAC00\uB2A5\uD55C \uBC84\uC804\uC758 Spotify\uAC00 \uC124\uCE58\uB418\uC5B4 \uC788\uB294\uC9C0 \uD655\uC778\uD558\uC2ED\uC2DC\uC624.",MAIN_MSG_ERROR_INIT:"\uD14C\uB9C8 \uB85C\uB4DC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4. \uC790\uC138\uD55C \uB0B4\uC6A9\uC740 \uCF58\uC194\uC744 \uD655\uC778\uD558\uC2ED\uC2DC\uC624.",MAIN_MSG_ERROR_INCOMPAT_EXT:"\uD638\uD658\uB418\uC9C0 \uC54A\uB294 \uD655\uC7A5 \uD504\uB85C\uADF8\uB7A8 %s\uC774(\uAC00) \uAC10\uC9C0\uB418\uC5C8\uC2B5\uB2C8\uB2E4! WMPotify\uC758 \uC77C\uBD80 \uAE30\uB2A5\uC774 \uBE44\uD65C\uC131\uD654\uB429\uB2C8\uB2E4.",TAB_NOW_PLAYING:"\uC9C0\uAE08 \uC7AC\uC0DD",TAB_LIBRARY:"\uB77C\uC774\uBE0C\uB7EC\uB9AC",PB_BTN_MINI_MODE:"\uBBF8\uB2C8 \uBAA8\uB4DC",PB_BTN_FULLSCREEN:"\uC804\uCCB4 \uD654\uBA74",LIBX_SIDEBAR_ROOT:"\uB77C\uC774\uBE0C\uB7EC\uB9AC",LIBX_HEADER_ROOT:"\uC74C\uC545",QUEUE_CURRENT_PLAYLIST_PLACEHOLDER:"\uC9C0\uAE08 \uC7AC\uC0DD",MENU_CONF:"WMPotify \uC18D\uC131",CONF_COLOR_TITLE:"\uC0C9 \uC120\uD0DD",CONF_COLOR_HUE:"\uC0C9\uC0C1",CONF_COLOR_SAT:"\uCC44\uB3C4",CONF_COLOR_TINTPB:"\uC9C0\uAE08 \uC7AC\uC0DD \uB9C9\uB300\uC758 \uBC84\uD2BC\uC5D0 \uC0C9\uC0C1 \uC801\uC6A9",CONF_GENERAL_TITLE:"\uC77C\uBC18",CONF_GENERAL_STYLE:"\uC2A4\uD0C0\uC77C",CONF_GENERAL_TITLE_STYLE:"\uC81C\uBAA9 \uC2A4\uD0C0\uC77C",CONF_GENERAL_TITLE_STYLE_NATIVE:"\uC2DC\uC2A4\uD15C",CONF_GENERAL_TITLE_STYLE_CUSTOM:"\uC790\uCCB4 \uAD6C\uD604",CONF_GENERAL_TITLE_STYLE_KEEPMENU:"\uBA54\uB274 \uC720\uC9C0",CONF_GENERAL_APPLY:"\uC801\uC6A9 (\uB2E4\uC2DC \uB85C\uB4DC \uD544\uC694)",CONF_GENERAL_FONT:"UI \uAE00\uAF34",CONF_GENERAL_CUSTOM_FONT_DLG_TITLE:"\uC0AC\uC6A9\uC790 \uC815\uC758 \uAE00\uAF34 \uC124\uC815",CONF_GENERAL_CUSTOM_FONT_MSG:"\uC62C\uBC14\uB978 CSS font-family \uC774\uB984 \uC785\uB825",CONF_GENERAL_TOPMOST:"\uD56D\uC0C1 \uC704\uC5D0 \uD45C\uC2DC",CONF_GENERAL_TOPMOST_ALWAYS:"\uD56D\uC0C1",CONF_GENERAL_TOPMOST_MINIMODE:"\uBBF8\uB2C8 \uBAA8\uB4DC\uC5D0\uC11C",CONF_GENERAL_TOPMOST_NEVER:"\uC548\uD568",CONF_GENERAL_BACKDROP:"\uBC30\uACBD \uC7AC\uC9C8",CONF_GENERAL_BACKDROP_NONE:"\uC5C6\uC74C (\uC7AC\uC2DC\uC791 \uD544\uC694)",CONF_GENERAL_BACKDROP_ACRYLIC:"\uC544\uD06C\uB9B4",CONF_GENERAL_BACKDROP_TABBED:"\uD0ED",CONF_GENERAL_SHOW_LIBX:"\uC67C\uCABD \uC0AC\uC774\uB4DC\uBC14\uC5D0 \uB77C\uC774\uBE0C\uB7EC\uB9AC X \uD45C\uC2DC",CONF_GENERAL_LOCK_TITLE:"\uC815\uC801 \uCC3D \uC81C\uBAA9 \uC0AC\uC6A9",CONF_GENERAL_WH_MESSAGE:'\uC77C\uBD80 \uC635\uC158\uC740 <a href="https://windhawk.net/mods/cef-titlebar-enabler-universal">CEF/Spotify Tweaks Windhawk \uBAA8\uB4DC</a>\uAC00 \uD544\uC694\uD569\uB2C8\uB2E4.',CONF_SPEED_TITLE:"\uC7AC\uC0DD \uC18D\uB3C4 \uC124\uC815",CONF_SPEED_SLOW:"\uB290\uB9AC\uAC8C",CONF_SPEED_NORMAL:"\uBCF4\uD1B5",CONF_SPEED_FAST:"\uBE60\uB974\uAC8C",CONF_SPEED_CURRENT_LABEL:"\uC7AC\uC0DD \uC18D\uB3C4",CONF_SPEED_CUSTOM_DLG_TITLE:"\uC7AC\uC0DD \uC18D\uB3C4 \uC124\uC815",CONF_SPEED_CUSTOM_MSG:"\uC7AC\uC0DD \uC18D\uB3C4\uB97C \uC785\uB825\uD558\uC2ED\uC2DC\uC624 (0.5 - 5.0)",CONF_SPEED_NO_CONNECT_MSG:"\uB2E4\uB978 \uC7A5\uCE58\uC5D0\uC11C \uC7AC\uC0DD \uC911\uC77C \uB54C\uB294 \uC7AC\uC0DD \uC18D\uB3C4\uB97C \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4",CONF_ABOUT_TITLE:"\uC815\uBCF4",CONF_ABOUT_DESC:"Spotify\uC6A9 Windows Media Player 11 \uD14C\uB9C8",CONF_ABOUT_VERSION:"\uBC84\uC804",CONF_ABOUT_CTEWH_VERSION:"CEF/Spotify Tweaks Windhawk \uBAA8\uB4DC %s \uC0AC\uC6A9 \uAC00\uB2A5",CONF_ABOUT_AUTHOR:"\uC81C\uC791: Ingan121",WMPVIS_INSTALL_TITLE:"WMPotify NowPlaying\uC744 \uC124\uCE58\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",WMPVIS_INSTALL_DESC:"WMPotify NowPlaying\uC740 WMP\uC640 \uAC19\uC740 \uC2DC\uAC01\uD654 \uD654\uBA74\uACFC \uADF8 \uC704\uC5D0 \uD45C\uC2DC\uB418\uB294 \uAC00\uC0AC \uCC3D\uC744 \uC81C\uACF5\uD569\uB2C8\uB2E4. WMPotify\uB97C \uCD5C\uC0C1\uC758 \uACBD\uD5D8\uC73C\uB85C \uC0AC\uC6A9\uD558\uB824\uBA74 WMPotify NowPlaying \uC124\uCE58\uB97C \uAD8C\uC7A5\uD569\uB2C8\uB2E4.",WMPVIS_INSTALL_STEPS:"\uC124\uCE58\uD558\uB824\uBA74 \uB2E4\uC74C \uB2E8\uACC4\uB97C \uB530\uB974\uC2ED\uC2DC\uC624:",WMPVIS_INSTALL_STEP1:"\uB2E4\uC74C \uCF54\uB4DC\uB97C \uBCF5\uC0AC\uD558\uC2ED\uC2DC\uC624:",WMPVIS_INSTALL_STEP2:"Win+R\uC744 \uB20C\uB7EC \uC2E4\uD589 \uB300\uD654 \uC0C1\uC790\uB97C \uC5FD\uB2C8\uB2E4",WMPVIS_INSTALL_STEP2_UNIX:"\uD130\uBBF8\uB110 \uCC3D\uC744 \uC5FD\uB2C8\uB2E4",WMPVIS_INSTALL_STEP3:"\uCF54\uB4DC\uB97C \uBD99\uC5EC\uB123\uACE0 \uC5D4\uD130 \uD0A4\uB97C \uB204\uB985\uB2C8\uB2E4",WMPVIS_INSTALL_MORE_INFO:"\uB610\uB294 \uC218\uB3D9 \uC124\uCE58 \uC9C0\uCE68\uC744 \uD3EC\uD568\uD55C \uC790\uC138\uD55C \uC815\uBCF4\uB97C \uBCF4\uB824\uBA74 %s\uD558\uC2ED\uC2DC\uC624.",WMPVIS_INSTALL_HIDE:"\uC124\uCE58\uD558\uC9C0 \uC54A\uC73C\uB824\uBA74 %s\uD558\uC5EC \uC774 \uBC84\uD2BC\uC744 \uC228\uAE30\uC2ED\uC2DC\uC624.",WMPVIS_INSTALL_CODE_COPY:"\uCF54\uB4DC\uAC00 \uD074\uB9BD\uBCF4\uB4DC\uC5D0 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!"},ot=vt;var Ne={"en-US":"English","ko-KR":"\uD55C\uAD6D\uC5B4"},K=navigator.language;if(!(K in Ne)){for(let e in Ne)if(K.slice(0,2)===e.slice(0,2)){K=e;break}K in Ne||(K="en-US")}var pe={"en-US":tt,"ko-KR":ot},fe=pe[K]||pe["en-US"];fe.getString=Tt;var c=fe;function Tt(e){return fe[e]?oe(fe[e],...Array.from(arguments).slice(1)):pe["en-US"][e]?(console.info(`Fallback string used for locId ${e}`),oe(pe["en-US"][e],...Array.from(arguments).slice(1))):(console.error(`No string found for locId ${e}`),e)}function oe(e){if(e=e.replace(/&([^&])/g,"<u>$1</u>").replace(/\\&/g,"&"),arguments.length>1)for(let t=1;t<arguments.length;t++)e=e.replace(/%s/,arguments[t]),e=e.replace(`%${t}s`,arguments[t]);return e}var ye=1,Mt={setControlHeight(e){ye=e||1},init(){if(Spicetify.Config.extensions.includes("noControls.js")){Spicetify.showNotification("[WMPotify] "+c.getString("MAIN_MSG_ERROR_INCOMPAT_EXT","No Controls"));return}let e=n=>{n&&(n._updateUiClient?.updateTitlebarHeight&&n._updateUiClient.updateTitlebarHeight({height:ye}),n._updateUiClient?.setButtonsVisibility&&ye<=1&&n._updateUiClient.setButtonsVisibility(!1),window.addEventListener("beforeunload",()=>{n._updateUiClient?.setButtonsVisibility&&n._updateUiClient.setButtonsVisibility({showButtons:!0})})),Spicetify.CosmosAsync?.post("sp://messages/v1/container/control",{type:"update_titlebar",height:ye+"px"})};e(Spicetify.Platform.ControlMessageAPI),e(Spicetify.Platform.UpdateAPI);async function t(){e(Spicetify.Platform.ControlMessageAPI),e(Spicetify.Platform.UpdateAPI)}let i=setInterval(t,100);setTimeout(()=>{clearInterval(i)},1e4);let o=()=>{e(Spicetify.Platform.ControlMessageAPI),e(Spicetify.Platform.UpdateAPI)};document.addEventListener("fullscreenchange",o),window.addEventListener("resize",()=>{setTimeout(()=>{o()},100)})}},Y=Mt;var Ae=document.createElement("canvas");Ae.width=1;Ae.height=1;var Se=Ae.getContext("2d");function Ot(e,t){return Se.fillStyle="#EEF3FA",Se.filter=`hue-rotate(${e}deg) saturate(${t}%)`,Se.fillRect(0,0,1,1),"rgba("+Se.getImageData(0,0,1,1).data+")"}function ie(e,t,i){if(!e&&!t){document.documentElement.style.setProperty("--spice-main","#EEF3FA"),document.documentElement.style.removeProperty("--wmpotify-tint-hue"),document.documentElement.style.removeProperty("--wmpotify-tint-sat");return}let o=document.querySelector(".main-nowPlayingBar-nowPlayingBar");o&&(i?o.classList.add("tinted"):o.classList.remove("tinted")),document.documentElement.style.setProperty("--spice-main",Ot(e,t)),document.documentElement.style.setProperty("--wmpotify-tint-hue",e+"deg"),document.documentElement.style.setProperty("--wmpotify-tint-sat",t/100)}var S=null,xe=1,Pt={init(){return It()},query(){return S?S.query():null},extendFrame(e,t,i,o){S?.extendFrame&&([e,t,i,o]=[e,t,i,o].map(n=>Math.round(n*window.devicePixelRatio)),xe>1&&([e,t]=[e&&e-1,t&&t-1],[i,o]=[i&&i-1,o&&o-1]),S.extendFrame(e,t,i,o))},minimize(){S?.minimize&&S.minimize()},maximizeRestore(){S?.maximizeRestore&&S.maximizeRestore()},close(){S?.close&&S.close()},setLayered(e,t,i){S?.setLayered&&S.setLayered(e,t,i)},setBackdrop(e){S?.setBackdrop&&S.setBackdrop(e)},resizeTo(e,t){S?.resizeTo&&S.resizeTo(e,t)},setMinSize(e,t){S?.setMinSize&&([e,t]=[e,t].map(i=>Math.round(i*window.devicePixelRatio)),S.setMinSize(e,t))},setTopMost(e){S?.setTopMost&&S.setTopMost(e)},setTitle(e){S?.setTitle&&S.setTitle(e)},lockTitle(e){S?.lockTitle&&S.lockTitle(e)},openSpotifyMenu(){S?.openSpotifyMenu&&S.openSpotifyMenu()},setPlaybackSpeed(e){S?.setPlaybackSpeed&&S.setPlaybackSpeed(parseFloat(e))},available(){return!!S},getModule(){return S}};function It(){if(navigator.userAgent.includes("Windows"))try{S=window.cancelEsperantoCall("ctewh"),xe=S.query().dpi/96;let{version:e,initialOptions:t}=S;return console.log(`CEF/Spotify Tweaks Windhawk mod available, Version: ${e}`),window.addEventListener("resize",()=>{xe=S.query().dpi/96}),{version:e,initialOptions:t}}catch{S=null,console.log("Windhawk mod not available")}}var m=Pt;async function nt(e){let t=m.query();switch(e){case"native":Y.setControlHeight(0);break;case"custom":Y.setControlHeight(0);case"keepmenu":let i=document.createElement("div");if(i.id="wmpotify-title-buttons",window.SpotEx||t){let l=document.createElement("button");l.id="wmpotify-minimize-button",l.addEventListener("click",()=>{window.SpotEx?SpotEx.updateWindow({state:"minimized"}):m.minimize()}),i.appendChild(l);let d=document.createElement("button");d.id="wmpotify-maximize-button",d.addEventListener("click",async()=>{window.SpotEx?(await SpotEx.getWindow()).state==="maximized"?SpotEx.updateWindow({state:"normal"}):SpotEx.updateWindow({state:"maximized"}):m.maximizeRestore()}),i.appendChild(d),window.addEventListener("resize",async()=>{window.SpotEx?(await SpotEx.getWindow()).state==="maximized"?d.dataset.maximized=!0:delete d.dataset.maximized:m.query().isMaximized?d.dataset.maximized=!0:delete d.dataset.maximized})}let o=document.createElement("button");o.id="wmpotify-close-button",o.addEventListener("click",()=>{it()}),i.appendChild(o);case"spotify":let n=document.createElement("div");n.id="wmpotify-title-bar";let r=document.createElement("div");r.id="wmpotify-title-icon",r.addEventListener("dblclick",()=>{it()}),n.appendChild(r);let a=document.createElement("span");a.id="wmpotify-title-text",a.textContent=await Spicetify.AppTitle.get(),n.appendChild(a),(e==="custom"||e==="keepmenu")&&n.appendChild(i),(e==="keepmenu"||e==="spotify")&&Y.setControlHeight(25),document.body.appendChild(n),Spicetify.AppTitle.sub(l=>{a.textContent=l});break}}async function it(){m.available()?m.close():window.close()}var j=class{constructor(t=[],i=[]){this.menuOrder=t,this.submenus=i,this.openedMenu=null,this.mouseOverMenu=!1,this.mouseOverSubmenu=!1,this.handlingPointerEvent=!1,this.handlingKeyEvent=!1,this.boundMenuNavigationHandler=this.menuNavigationHandler.bind(this),this.submenuOpenTimer=null,this.submenuCloseTimer=null,this.shouldNotCloseSubmenu=!1,this.menuHierarchy={},this.beforeMenuOpenEvent=new Event("beforemenuopen"),this.afterMenuCloseEvent=new Event("aftermenuclose");for(let o of t){this.menuHierarchy[o]=[];let n=document.getElementById(o+"MenuBg"),r=n.querySelectorAll(".contextMenuItem");for(let a of r)a.dataset.submenu&&this.menuHierarchy[o].push(a.dataset.submenu),a.addEventListener("pointerover",()=>{for(let l of r)delete l.dataset.active;a.dataset.active=!0,clearTimeout(this.submenuOpenTimer),a.dataset.submenu?this.submenuOpenTimer=setTimeout(()=>{this.openMenu(a.dataset.submenu)},300):this.menuHierarchy[o].length>0&&this.delayedCloseMenu(this.menuHierarchy[o][0])}),a.addEventListener("pointerleave",()=>{this.mouseOverSubmenu||(delete a.dataset.active,clearTimeout(this.submenuOpenTimer),a.dataset.submenu&&this.delayedCloseMenu(a.dataset.submenu))}),a.addEventListener("click",()=>{a.dataset.submenu&&!a.classList.contains("disabled")?this.openedMenu.id!==a.dataset.submenu+"MenuBg"?this.openMenu(a.dataset.submenu):document.getElementById(a.dataset.submenu+"MenuBg").focus():a.dataset.noClose||this.closeMenu(o)});n.addEventListener("focusout",a=>{top.ignoreFocusLoss||a.relatedTarget&&a.relatedTarget.dataset.submenuOf===o||this.closeMenu(o)}),n.addEventListener("pointermove",a=>{(a.clientX>0||a.clientY>0)&&(n.style.animation="none")})}for(let o of i){let n=document.getElementById(o+"MenuBg"),r=n.querySelectorAll(".contextMenuItem"),a=document.getElementById(n.dataset.submenuOf+"MenuBg"),l=Array.from(a.querySelectorAll(".contextMenuItem")).findIndex(u=>u.dataset.submenu===o),d=a.querySelectorAll(".contextMenuItem")[l];for(let u of r)u.addEventListener("pointerover",()=>{for(let p of r)delete p.dataset.active;u.dataset.active=!0}),u.addEventListener("pointerleave",()=>{delete u.dataset.active}),u.addEventListener("click",()=>{this.shouldNotCloseSubmenu=!1,this.closeMenu(o),this.closeMenu(n.dataset.submenuOf)});n.addEventListener("pointerover",()=>{this.mouseOverMenu=!0,this.mouseOverSubmenu=!0,this.shouldNotCloseSubmenu=!0,clearTimeout(this.submenuCloseTimer),d.dataset.active=!0}),n.addEventListener("pointerleave",()=>{this.mouseOverMenu=!1,this.mouseOverSubmenu=!1,this.shouldNotCloseSubmenu=!1}),n.addEventListener("focusout",u=>{if(top.ignoreFocusLoss||n.style.display==="none")return;this.shouldNotCloseSubmenu=!1;let p=!!n.dataset.openStandalone;u.relatedTarget&&u.relatedTarget.id&&u.relatedTarget.id===a.id||(this.closeMenu(o),!(u.relatedTarget&&u.relatedTarget.id&&u.relatedTarget.dataset.submenuOf===n.dataset.submenuOf)&&(p||this.closeMenu(n.dataset.submenuOf)))})}}openMenu(t,i){let o=document.getElementById(t+"MenuBg"),n=document.getElementById(t+"Menu"),r=!!o.dataset.submenuOf,a,l,d,u=o.querySelectorAll(".contextMenuItem.debug");if(localStorage.wmpotifyDebugMode){d=o.querySelectorAll(".contextMenuItem:not([data-hidden])");for(let f of u)f.style.display=""}else{d=o.querySelectorAll(".contextMenuItem:not([data-hidden]):not(.debug)");for(let f of u)f.style.display="none"}if(o.dispatchEvent(this.beforeMenuOpenEvent),i)o.dataset.openStandalone=!0;else{if(r){if(this.menuHierarchy[o.dataset.submenuOf].length>1)for(let h of this.menuHierarchy[o.dataset.submenuOf])h!==t&&this.closeMenu(h);if(a=document.getElementById(o.dataset.submenuOf+"MenuBg"),a.style.display==="none")return;let f=Array.from(a.querySelectorAll(".contextMenuItem")).findIndex(h=>h.dataset.submenu===t);if(l=a.querySelectorAll(".contextMenuItem")[f],l.classList.contains("disabled"))return}else for(let f of this.menuOrder)f!==t&&document.getElementById(f+"MenuBg").style.display==="block"&&this.closeMenu(f);delete o.dataset.openStandalone}o.style.animation="";for(let f of d)delete f.dataset.active;if(i)i.top&&(o.style.top=i.top),i.left&&(o.style.left=i.left),i.right&&(o.style.right=i.right),i.bottom&&(o.style.bottom=i.bottom);else{let f="",h=0;r&&(f=a.offsetTop+l.offsetTop,h=a.offsetLeft+a.offsetWidth-6),o.style.top=f+"px",o.style.left=h+"px"}o.style.display="block";let p=this.calcMenuWidth(t);o.style.width=p+")",o.style.minWidth=0,n.style.width=p+" - 2px)",o.style.height=this.calcMenuHeight(t)+"px",i||r&&(l.dataset.active=!0),o.focus(),this.openedMenu=o,document.addEventListener("keydown",this.boundMenuNavigationHandler)}closeMenu(t){let i=document.getElementById(t+"MenuBg"),o=!!i.dataset.openStandalone,n=!!i.dataset.submenuOf&&!o;if(n&&this.shouldNotCloseSubmenu)return;let r,a;if(!o&&n){r=document.getElementById(i.dataset.submenuOf+"MenuBg");let l=Array.from(r.querySelectorAll(".contextMenuItem")).findIndex(d=>d.dataset.submenu===t);a=r.querySelectorAll(".contextMenuItem")[l]}this.submenuCloseTimer&&clearTimeout(this.submenuCloseTimer),i.style.display="none",o?delete i.dataset.openStandalone:n&&delete a.dataset.active,i.dispatchEvent(this.afterMenuCloseEvent),n&&r.style.display!=="none"?(r.focus(),this.openedMenu=r):(this.openedMenu=null,document.removeEventListener("keydown",this.boundMenuNavigationHandler))}delayedCloseMenu(t){this.submenuCloseTimer=setTimeout(()=>{this.closeMenu(t)},300)}menuNavigationHandler(t){if(!this.openedMenu)return;let i;localStorage.wmpotifyDebugMode?i=this.openedMenu.querySelectorAll(".contextMenuItem"):i=this.openedMenu.querySelectorAll(".contextMenuItem:not(.debug)");let o=this.openedMenu.querySelector(".contextMenuItem[data-active]"),n=Array.from(i).indexOf(o),r;switch(this.openedMenu.dataset.submenuOf&&(r=document.getElementById(this.openedMenu.dataset.submenuOf+"MenuBg").querySelector(".contextMenuItem[data-active]")),this.handlingKeyEvent=!0,this.openedMenu.style.animation="none",t.key){case"Escape":this.mouseOverMenu=!1,this.openedMenu.blur();break;case"ArrowUp":o?(delete o.dataset.active,n>0?i[n-1].dataset.active=!0:i[i.length-1].dataset.active=!0):i[i.length-1].dataset.active=!0;break;case"ArrowDown":o?(delete o.dataset.active,n<i.length-1?i[n+1].dataset.active=!0:i[0].dataset.active=!0):i[0].dataset.active=!0;break;case"ArrowLeft":if(this.openedMenu.dataset.submenuOf){this.closeMenu(this.openedMenu.id.slice(0,-6),!0),r.dataset.active=!0;break}if(this.menuOrder.length===1)break;let a=this.menuOrder[(this.menuOrder.indexOf(this.openedMenu.id.slice(0,-6))+this.menuOrder.length-1)%this.menuOrder.length];this.closeMenu(this.openedMenu.id.slice(0,-6)),this.openMenu(a),this.openedMenu.querySelector(".contextMenuItem").dataset.active=!0;break;case"ArrowRight":if(o&&o.dataset.submenu){this.openMenu(o.dataset.submenu),this.openedMenu.querySelector(".contextMenuItem").dataset.active=!0;break}if(this.menuOrder.length===1)break;let l;this.openedMenu.dataset.submenuOf?(l=this.menuOrder[(this.menuOrder.indexOf(this.openedMenu.dataset.submenuOf)+1)%this.menuOrder.length],this.closeMenu(this.openedMenu.id.slice(0,-6))):(l=this.menuOrder[(this.menuOrder.indexOf(this.openedMenu.id.slice(0,-6))+1)%this.menuOrder.length],this.closeMenu(this.openedMenu.id.slice(0,-6))),this.openMenu(l),this.openedMenu.querySelector(".contextMenuItem").dataset.active=!0;break;case"Enter":if(o)o.click();else{this.openedMenu.blur();break}break;default:let d=this.openedMenu.getElementsByTagName("u");for(let u of d)if(t.key===u.textContent.toLowerCase()){u.parentElement.click();break}}this.handlingKeyEvent=!1,t.preventDefault(),t.stopPropagation()}calcMenuWidth(t){let i=document.getElementById(t+"MenuBg"),o;localStorage.wmpotifyDebugMode?o=i.querySelectorAll(".contextMenuItem:not([data-hidden])"):o=i.querySelectorAll(".contextMenuItem:not([data-hidden]):not(.debug)"),i.style.minWidth="";let n=parseInt(getComputedStyle(i).minWidth)||0;return`calc(${Array.from(o).reduce((a,l)=>{let d=l.textContent,u=Be(d);return Math.max(n,a,u)},0)}px + 4.5em`}calcMenuHeight(t){let i=document.getElementById(t+"MenuBg"),o=i.querySelectorAll("hr"),n;localStorage.wmpotifyDebugMode?n=i.querySelectorAll(".contextMenuItem:not([data-hidden])"):n=i.querySelectorAll(".contextMenuItem:not([data-hidden]):not(.debug)");let r=n[0].offsetHeight,a=0;if(o.length>0){let d=getComputedStyle(o[0]);a=o[0].offsetHeight+parseFloat(d.marginTop)+parseFloat(d.marginBottom)}return parseInt(n.length*r+o.length*a)}};function he(e,t,i){let o=document.createElement("div");return o.id=e+"MenuBg",o.className="contextMenuBg",o.tabIndex=-1,o.style.display="none",o.innerHTML=`<div id="${e}Menu" class="contextMenu"></div>`,i&&(o.dataset.submenuOf=i),t.forEach(n=>{if(n.hr){let a=document.createElement("hr");o.querySelector(".contextMenu").appendChild(a);return}let r=document.createElement("div");r.className="contextMenuItem",n.args?r.innerHTML="<p>"+oe(n.text,...n.args)+"</p>":r.innerHTML="<p>"+oe(n.text)+"</p>",n.classList&&r.classList.add(...n.classList),n.disabled&&r.classList.add("disabled"),n.hidden&&(r.dataset.hidden=!0),n.submenu&&(r.dataset.submenu=n.submenu,r.innerHTML+='<p class="submenuMark">\u23F5</p>'),n.noClose&&(r.dataset.noClose=!0),r.addEventListener("click",n.click),o.querySelector(".contextMenu").appendChild(r)}),document.body.appendChild(o),{menuBg:o,menu:o.querySelector(".contextMenu"),menuItems:o.querySelectorAll(".contextMenuItem")}}function Be(e,t=getComputedStyle(document.documentElement).getPropertyValue("--menu-font")){let o=(Be.canvas||(Be.canvas=document.createElement("canvas"))).getContext("2d");return o.font=t,o.measureText(e).width}var H,q=[],J,Nt={"Friend Activity":"Friends"};function at(){let e=document.querySelector(".Root__globalNav");H=document.createElement("div"),H.id="wmpotify-tabs-container",e.insertBefore(H,e.querySelector(".main-globalNav-searchSection"));let t=document.querySelector('.custom-navlinks-scrollable_container div[role="presentation"] > button:has(#wmpotify-nowplaying-icon)');t||(t=document.createElement("button"),t.addEventListener("click",()=>{if(Spicetify.Config.custom_apps.includes("wmpvis"))Spicetify.Platform.History.push({pathname:"/wmpvis"});else{let w=document.createElement("div");w.id="wmpotify-wmpvis-install-dialog",w.innerHTML=`
                    <p>${c.WMPVIS_INSTALL_DESC}</p><br>
                    <img src="https://raw.githubusercontent.com/Ingan121/WMPotify/refs/heads/master/screenshots/wmpvis_aero_2.png" alt="WMPotify NowPlaying screenshot"><br><br>
                    <p>${c.WMPVIS_INSTALL_STEPS}</p><br>
                    <ol>
                        <li>1. ${c.WMPVIS_INSTALL_STEP1}</li>
                        <div class="wmpotify-code-container">
                            <button id="wmpotify-copy-code">
                                
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-copy" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"/>
                                </svg>
                            </button>
                            <code>
                            ${navigator.userAgent.includes("Windows")?`powershell -command "iex ""& { $(iwr -useb '<a href="https://raw.githubusercontent.com/Ingan121/WMPotify/master/installer/install.ps1">https://raw.githubusercontent.com/Ingan121/WMPotify/master/installer/install.ps1</a>') } -Install @('wmpvis')"""`:'export SKIP_THEME=true; curl -fsSL <a href="https://raw.githubusercontent.com/Ingan121/WMPotify/master/installer/install.sh">https://raw.githubusercontent.com/Ingan121/WMPotify/master/installer/install.sh</a> | sh'}
                            </code>
                        </div>
                        <li>2. ${c[navigator.userAgent.includes("Windows")?"WMPVIS_INSTALL_STEP2":"WMPVIS_INSTALL_STEP2_UNIX"]}</li>
                        <li>3. ${c.WMPVIS_INSTALL_STEP3}</li>
                    </ol><br>
                    <p>${c.getString("WMPVIS_INSTALL_MORE_INFO",`<a href="https://github.com/Ingan121/WMPotify">${c.UI_CLICK_HERE}</a>`)}</p>
                    <p>${c.getString("WMPVIS_INSTALL_HIDE",`<a href="javascript:localStorage.wmpotifyNoWmpvis=true;document.querySelector('#wmpotify-tabs-container button[data-identifier=now-playing]').dataset.hidden=true;Spicetify.PopupModal.hide();window.dispatchEvent(new Event('resize'))">${c.UI_CLICK_HERE}</a>`)}</p>
                `,Spicetify.PopupModal.display({title:c.WMPVIS_INSTALL_TITLE,content:w}),document.querySelector("#wmpotify-copy-code").addEventListener("click",()=>{let G=document.querySelector("#wmpotify-wmpvis-install-dialog code").textContent.trim();Spicetify.Platform.ClipboardAPI.copy(G)})}}),localStorage.wmpotifyNoWmpvis&&!Spicetify.Config.custom_apps.includes("wmpvis")&&(t.dataset.hidden=!0)),t.setAttribute("aria-label",c.TAB_NOW_PLAYING),t.dataset.identifier="now-playing",Q(t);let i=document.querySelector(".main-globalNav-searchContainer > button");i.dataset.identifier="home",Q(i);let o=document.querySelector(".main-globalNav-searchContainer div form button");o.dataset.identifier="search",o.addEventListener("click",w=>{Spicetify.Platform.History.push({pathname:"/search"}),w.preventDefault(),w.stopPropagation()}),Q(o);let n=document.createElement("button");n.id="wmpotify-library-button",n.dataset.identifier="library",n.setAttribute("aria-label",c.TAB_LIBRARY),n.addEventListener("click",()=>{Spicetify.Platform.History.push({pathname:"/wmpotify-standalone-libx"})}),Q(n),q=[t,i,o,n];let r=document.querySelectorAll('.custom-navlinks-scrollable_container div[role="presentation"] > button');for(let w of r)Q(w),q.push(w);let a=document.querySelectorAll(".main-topBar-topbarContentRight > .main-actionButtons > button");for(let w of a)Q(w),q.push(w);let l=[];for(let w of q)l.push({text:w.querySelector(".wmpotify-tab-label").textContent,click:()=>w.click()});he("wmpotifyTab",l);let d=new j(["wmpotifyTab"]);J=document.createElement("button"),J.id="wmpotify-tabs-overflow-button",J.addEventListener("click",()=>{d.openMenu("wmpotifyTab",{top:"0",left:J.getBoundingClientRect().left+"px"})}),H.appendChild(J),be(),setTimeout(be,1e3),window.addEventListener("resize",be),document.addEventListener("fullscreenchange",be);let u=document.querySelector(".main-topBar-topbarContentRight > button:last-child"),p=document.createElement("span");p.textContent=u.getAttribute("aria-label"),p.classList.add("wmpotify-user-label"),u.appendChild(p);let f=document.createElement("div");f.id="wmpotify-search-container";let h=document.createElement("div");h.id="wmpotify-search-wrapper";let L=document.querySelector('.main-globalNav-searchContainer div form input[type="search"]');h.appendChild(L);let I=document.createElement("button");I.id="wmpotify-search-clear-button",I.setAttribute("aria-label","Clear search"),I.addEventListener("click",()=>{L.value="",L.focus(),Spicetify.Platform.History.push({pathname:"/search"})}),h.appendChild(I),f.appendChild(h),e.appendChild(f),e.addEventListener("pointerdown",w=>{w.button===2&&!w.target.closest("input")&&m.openSpotifyMenu()});let g=getComputedStyle(document.documentElement).getPropertyValue("--right-sidebar-width");g&&document.documentElement.style.setProperty("--panel-width",g)}function Q(e){H.appendChild(e);let t=document.createElement("span"),i=e.getAttribute("aria-label");t.textContent=Nt[i]||i,t.classList.add("wmpotify-tab-label"),e.appendChild(t)}function be(){let e=document.querySelector(".main-globalNav-historyButtons").getBoundingClientRect().right,t=window.innerWidth-document.querySelector(".main-topBar-topbarContentRight").getBoundingClientRect().left,i=160,o=0;for(;window.innerWidth-e-t-i<H.getBoundingClientRect().width&&o<q.length;)q[q.length-1-o++].dataset.hidden=!0;for(o=document.querySelectorAll("#wmpotify-tabs-container button[data-hidden]").length;o>0&&window.innerWidth-e-t-i>H.getBoundingClientRect().width;)delete q[q.length-o--].dataset.hidden;J.style.display=o>0?"block":""}function ge(e,t){if(!e||isNaN(e))return"00:00";let i=Math.floor(e/1e3),o=Math.floor(i/60);if(i=String(i%60).padStart(2,"0"),o<60)return t&&(o=String(o).padStart(2,"0")),`${o}:${i}`;let n=Math.floor(o/60);return o=String(o%60).padStart(2,"0"),t&&(n=String(n).padStart(2,"0")),`${n}:${o}:${i}`}function ke(e,t,i,o){return new Promise((n,r)=>{let a=document.createElement("div");a.id="wmpotify-prompt-modal";let l=document.createElement("p");l.textContent=t,a.appendChild(l);let d=document.createElement("input");d.classList.add("wmpotify-aero"),d.type="text",d.value=i,d.placeholder=o,d.style.width="100%",a.appendChild(d);let u=document.createElement("div");u.classList.add("wmpotify-modal-bottom-buttons");let p=document.createElement("button");p.classList.add("wmpotify-aero"),p.textContent="OK",p.addEventListener("click",()=>{n(d.value),Spicetify.PopupModal.hide()}),u.appendChild(p);let f=document.createElement("button");f.classList.add("wmpotify-aero"),f.textContent="Cancel",f.addEventListener("click",()=>{n(null),Spicetify.PopupModal.hide()}),u.appendChild(f),a.appendChild(u),Spicetify.PopupModal.display({title:e,content:a});let h=new MutationObserver(()=>{document.contains(a)||(h.disconnect(),n(null))});h.observe(document.body,{childList:!0})})}var rt={};(function e(t,i,o){function n(l,d){if(!i[l]){if(!t[l]){var u=typeof te=="function"&&te;if(!d&&u)return u(l,!0);if(r)return r(l,!0);var p=new Error("Cannot find module '"+l+"'");throw p.code="MODULE_NOT_FOUND",p}var f=i[l]={exports:{}};t[l][0].call(f.exports,function(h){var L=t[l][1][h];return n(L||h)},f,f.exports,e,t,i,o)}return i[l].exports}for(var r=typeof te=="function"&&te,a=0;a<o.length;a++)n(o[a]);return n})({1:[function(e,t,i){var o,n,r;o=function(a,l){var d;return d=setTimeout(l,a),{stop:function(){return clearTimeout(d)}}},r=function(a,l){var d;return d=setInterval(l,a),{stop:function(){return clearInterval(d)}}},n=function(a){return/in/.test(document.readyState)?o(10,function(){return n(a)}):a()},function(a){var l,d,u,p,f,h,L,I,g,w,G;return l=a.FontDetective={},h=["serif","sans-serif","cursive","fantasy","monospace"],I="Helvetica,Lucida Grande,Lucida Sans,Tahoma,Arial,Geneva,Monaco,Verdana,Microsoft Sans Serif,Trebuchet MS,Courier New,Times New Roman,Courier,Lucida Bright,Lucida Sans Typewriter,URW Chancery L,Comic Sans MS,Georgia,Palatino Linotype,Lucida Sans Unicode,Times,Century Schoolbook L,URW Gothic L,Franklin Gothic Medium,Lucida Console,Impact,URW Bookman L,Helvetica Neue,Nimbus Sans L,URW Palladio L,Nimbus Mono L,Nimbus Roman No9 L,Arial Black,Sylfaen,MV Boli,Estrangelo Edessa,Tunga,Gautami,Raavi,Mangal,Shruti,Latha,Kartika,Vrinda,Arial Narrow,Century Gothic,Garamond,Book Antiqua,Bookman Old Style,Calibri,Cambria,Candara,Corbel,Monotype Corsiva,Cambria Math,Consolas,Constantia,MS Reference Sans Serif,MS Mincho,Segoe UI,Arial Unicode MS,Tempus Sans ITC,Kristen ITC,Mistral,Meiryo UI,Juice ITC,Papyrus,Bradley Hand ITC,French Script MT,Malgun Gothic,Microsoft YaHei,Gisha,Leelawadee,Microsoft JhengHei,Haettenschweiler,Microsoft Himalaya,Microsoft Uighur,MoolBoran,Jokerman,DFKai-SB,KaiTi,SimSun-ExtB,Freestyle Script,Vivaldi,FangSong,MingLiU-ExtB,MingLiU_HKSCS,MingLiU_HKSCS-ExtB,PMingLiU-ExtB,Copperplate Gothic Light,Copperplate Gothic Bold,Copperplate Gothic,Franklin Gothic Book,Maiandra GD,Perpetua,Eras Demi ITC,Felix Titling,Franklin Gothic Demi,Pristina,Edwardian Script ITC,OCR A Extended,OCR A,Engravers MT,Eras Light ITC,Franklin Gothic Medium Cond,Rockwell Extra Bold,Rockwell,Curlz MT,Blackadder ITC,Franklin Gothic Heavy,Franklin Gothic Demi Cond,Lucida Handwriting,Segoe UI Light,Segoe UI Semibold,Lucida Calligraphy,Cooper Black,Viner Hand ITC,Britannic Bold,Wide Latin,Old English Text MT,Broadway,Footlight MT Light,Harrington,Snap ITC,Onyx,Playbill,Bauhaus 93,Baskerville Old Face,Algerian,Matura MT Script Capitals,Stencil,Batang,Chiller,Harlow Solid Italic,Kunstler Script,Bernard MT Condensed,Informal Roman,Vladimir Script,Bell MT,Colonna MT,High Tower Text,Californian FB,Ravie,Segoe Script,Brush Script MT,SimSun,Arial Rounded MT Bold,Berlin Sans FB,Centaur,Niagara Solid,Showcard Gothic,Niagara Engraved,Segoe Print,Gabriola,Gill Sans MT,Iskoola Pota,Calisto MT,Script MT Bold,Century Schoolbook,Berlin Sans FB Demi,Magneto,Arabic Typesetting,DaunPenh,Mongolian Baiti,DokChampa,Euphemia,Kalinga,Microsoft Yi Baiti,Nyala,Bodoni MT Poster Compressed,Goudy Old Style,Imprint MT Shadow,Gill Sans MT Condensed,Gill Sans Ultra Bold,Palace Script MT,Lucida Fax,Gill Sans MT Ext Condensed Bold,Goudy Stout,Eras Medium ITC,Rage Italic,Rockwell Condensed,Castellar,Eras Bold ITC,Forte,Gill Sans Ultra Bold Condensed,Perpetua Titling MT,Agency FB,Tw Cen MT,Gigi,Tw Cen MT Condensed,Aparajita,Gloucester MT Extra Condensed,Tw Cen MT Condensed Extra Bold,PMingLiU,Bodoni MT,Bodoni MT Black,Bodoni MT Condensed,MS Gothic,GulimChe,MS UI Gothic,MS PGothic,Gulim,MS PMincho,BatangChe,Dotum,DotumChe,Gungsuh,GungsuhChe,MingLiU,NSimSun,SimHei,DejaVu Sans,DejaVu Sans Condensed,DejaVu Sans Mono,DejaVu Serif,DejaVu Serif Condensed,Eurostile,Matisse ITC,Bitstream Vera Sans Mono,Bitstream Vera Sans,Staccato222 BT,Bitstream Vera Serif,Broadway BT,ParkAvenue BT,Square721 BT,Calligraph421 BT,MisterEarl BT,Cataneo BT,Ruach LET,Rage Italic LET,La Bamba LET,Blackletter686 BT,John Handy LET,Scruff LET,Westwood LET,Yu Gothic,Yu Gothic UI".split(",").sort(),G=[],p=!1,g=!1,u=document.createElement("div"),u.id="font-detective",d=function(){function E(v,C,b){this.name=v,this.type=C,this.style=b}return E.prototype.toString=function(){return'"'+this.name.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},E}(),f=function(){var E,v,C,b;return E=["monospace","sans-serif","serif"],b=document.createElement("span"),b.innerHTML="mmmmmmmmmmlli",b.style.fontSize="72px",C={},v={},{init:function(){var T,M,R,N;for(document.body.appendChild(u),N=[],M=0,R=E.length;M<R;M++)T=E[M],b.style.fontFamily=T,u.appendChild(b),C[T]=b.offsetWidth,v[T]=b.offsetHeight,N.push(u.removeChild(b));return N},check:function(T){var M,R,N,D;for(N=0,D=E.length;N<D;N++)if(M=E[N],b.style.fontFamily=T+", "+M,u.appendChild(b),R=b.offsetWidth!==C[M]||b.offsetHeight!==v[M],u.removeChild(b),R)return!0;return!1}}}(),L=function(){if(!g)return g=!0,l.incomplete=!0,n(function(E){return function(){var v;return w(function(){var C,b,T;for(T=[],C=0,b=I.length;C<b;C++)v=I[C],T.push(new d(v));return T}())}}(this))},w=function(E){var v,C;return f.init(),v=0,C=r(20,function(){var b,T,M,R,N,D,Ze,et,Pe,Ie;for(R=0;R<=5;R++){if(M=E[v],b=f.check(M),b)for(G.push(M),Pe=l.each.callbacks,N=0,Ze=Pe.length;N<Ze;N++)T=Pe[N],T(M);if(v++,v>=E.length){for(C.stop(),Ie=l.all.callbacks,D=0,et=Ie.length;D<et;D++)T=Ie[D],T(G);l.all.callbacks=[],l.each.callbacks=[],p=!0;return}}})},l.preload=L,l.each=function(E){var v,C,b;for(C=0,b=G.length;C<b;C++)v=G[C],E(v);if(!p)return l.each.callbacks.push(E),L()},l.each.callbacks=[],l.all=function(E){return p?E(G):(l.all.callbacks.push(E),L())},l.all.callbacks=[]}(rt)},{}]},{},[1]);var lt=rt.FontDetective;var y=document.createElement("div"),W=null,Re=0,we=null,s={title:null,hue:null,sat:null};function At(){if(document.getElementById("wmpotify-config"))return;let e=m.query(),t=document.querySelector(".Root__main-view");y.id="wmpotify-config",y.innerHTML=`
        <div id="wmpotify-config-topborder" class="wmpotify-tintable"></div>
        <button id="wmpotify-config-prev"></button>
        <button id="wmpotify-config-next"></button>
        <p id="wmpotify-config-title">${c.CONF_COLOR_TITLE}</p>
        <button id="wmpotify-config-close"></button>
        <section class="wmpotify-config-tab-content" data-tab-title="${c.CONF_COLOR_TITLE}" style="display: block;">
            <section class="field-row">
                <a href="#" id="wmpotify-config-color-reset">${c.UI_RESET}</a>
                <input type="checkbox" id="wmpotify-config-tint-playerbar" class="wmpotify-aero">
                <label for="wmpotify-config-tint-playerbar">${c.CONF_COLOR_TINTPB}</label>
            </section>
            <label>${c.CONF_COLOR_HUE}</label><br>
            <input type="range" id="wmpotify-config-hue" class="wmpotify-aero no-track" min="0" max="360" step="1" value="180"><br>
            <label>${c.CONF_COLOR_SAT}</label><br>
            <input type="range" id="wmpotify-config-sat" class="wmpotify-aero no-track" min="0" max="354" step="1" value="121"><br>
        </section>
        <section class="wmpotify-config-tab-content" data-tab-title="${c.CONF_GENERAL_TITLE}">
            <label for="wmpotify-config-style">${c.CONF_GENERAL_STYLE}</label>
            <select id="wmpotify-config-style" class="wmpotify-aero">
                <option value="auto">${c.UI_AUTO}</option>
                <option value="xp">XP</option>
                <option value="aero">Aero</option>
                <option value="basic">Basic</option>
            </select>
            <label for="wmpotify-config-title-style">${c.CONF_GENERAL_TITLE_STYLE}</label>
            <select id="wmpotify-config-title-style" class="wmpotify-aero">
                <option value="auto">${c.UI_AUTO}</option>
                <option value="native">${c.CONF_GENERAL_TITLE_STYLE_NATIVE}</option>
                <option value="custom">${c.CONF_GENERAL_TITLE_STYLE_CUSTOM}</option>
                <option value="spotify">Spotify</option>
                <option value="keepmenu">${c.CONF_GENERAL_TITLE_STYLE_KEEPMENU}</option>
            </select>
            <button id="wmpotify-config-apply" class="wmpotify-aero">${c.CONF_GENERAL_APPLY}</button><br>
            <label for="wmpotify-config-font">${c.CONF_GENERAL_FONT}</label>
            <select id="wmpotify-config-font" class="wmpotify-aero">
                <option value="custom">${c.UI_CUSTOM}</option>
            </select><br>
            <label for="wmpotify-config-topmost">${c.CONF_GENERAL_TOPMOST}</label>
            <select id="wmpotify-config-topmost" class="wmpotify-aero" disabled>
                <option value="always">${c.CONF_GENERAL_TOPMOST_ALWAYS}</option>
                <option value="minimode">${c.CONF_GENERAL_TOPMOST_MINIMODE}</option>
                <option value="never" selected>${c.CONF_GENERAL_TOPMOST_NEVER}</option>
            </select>
            <label for="wmpotify-config-backdrop">${c.CONF_GENERAL_BACKDROP}</label>
            <select id="wmpotify-config-backdrop" class="wmpotify-aero" disabled>
                <option value="none" selected>${c.CONF_GENERAL_BACKDROP_NONE}</option>
                <option value="mica">Mica</option>
                <option value="acrylic">${c.CONF_GENERAL_BACKDROP_ACRYLIC}</option>
                <option value="tabbed">${c.CONF_GENERAL_BACKDROP_TABBED}</option>
            </select><br>
            <input type="checkbox" id="wmpotify-config-show-libx" class="wmpotify-aero">
            <label for="wmpotify-config-show-libx">${c.CONF_GENERAL_SHOW_LIBX}</label>
            <input type="checkbox" id="wmpotify-config-lock-title" class="wmpotify-aero" disabled>
            <label for="wmpotify-config-lock-title">${c.CONF_GENERAL_LOCK_TITLE}</label><br>
            <span id="wmpotify-config-wh-message">${c.CONF_GENERAL_WH_MESSAGE}</span>
        </section>
        ${e?.speedModSupported?`
        <section class="wmpotify-config-tab-content" data-tab-title="${c.CONF_SPEED_TITLE}" data-wh-speedmod-required="true">
            <a href="#" id="wmpotify-config-speed-slow">${c.CONF_SPEED_SLOW}</a>
            <a href="#" id="wmpotify-config-speed-normal">${c.CONF_SPEED_NORMAL}</a>
            <a href="#" id="wmpotify-config-speed-fast">${c.CONF_SPEED_FAST}</a><br>
            <input type="range" id="wmpotify-config-speed" class="wmpotify-aero" min="0.5" max="2.0" step="0.1" value="1"><br>
            ${c.CONF_SPEED_CURRENT_LABEL}: <span id="wmpotify-config-speed-value">1.0</span>
        </section>
        `:""}
        <section class="wmpotify-config-tab-content" data-tab-title="${c.CONF_ABOUT_TITLE}">
            <div id="wmpotify-about-logo"></div>
            <p id="wmpotify-about-title">WMPotify</p><br>
            <p>${c.CONF_ABOUT_DESC}</p>
            <p>${c.CONF_ABOUT_VERSION}: 1.0 Beta 2<span id="wmpotify-about-ctewh-ver"></span></p>
            <p>${c.CONF_ABOUT_AUTHOR} - <a href="https://www.ingan121.com/" target="_blank">www.ingan121.com</a></p>
            <a href="https://github.com/Ingan121/WMPotify" target="_blank">GitHub</a>
        </section>
    `,W=y.querySelectorAll(".wmpotify-config-tab-content"),s.topborder=y.querySelector("#wmpotify-config-topborder"),s.title=y.querySelector("#wmpotify-config-title"),s.hue=y.querySelector("#wmpotify-config-hue"),s.sat=y.querySelector("#wmpotify-config-sat"),s.tintPb=y.querySelector("#wmpotify-config-tint-playerbar"),s.fontSelector=y.querySelector("#wmpotify-config-font"),s.fontCustom=y.querySelector("#wmpotify-config-font option"),s.topmost=y.querySelector("#wmpotify-config-topmost"),s.backdrop=y.querySelector("#wmpotify-config-backdrop"),s.showLibX=y.querySelector("#wmpotify-config-show-libx"),s.lockTitle=y.querySelector("#wmpotify-config-lock-title"),s.whMessage=y.querySelector("#wmpotify-config-wh-message"),s.whVer=y.querySelector("#wmpotify-about-ctewh-ver"),y.style.height=localStorage.wmpotifyConfigHeight||"",s.fontSelector.addEventListener("change",async()=>{if(s.fontSelector.value==="custom"){let a=await ke(c.CONF_GENERAL_CUSTOM_FONT_DLG_TITLE,c.CONF_GENERAL_CUSTOM_FONT_MSG,"",localStorage.wmpotifyFont||"Segoe UI");if(!a){s.fontSelector.value=localStorage.wmpotifyFont||"Segoe UI";return}s.fontCustom.textContent=a,localStorage.wmpotifyFont=a}else s.fontCustom.textContent=c.UI_CUSTOM,localStorage.wmpotifyFont=s.fontSelector.value;document.documentElement.style.setProperty("--ui-font",localStorage.wmpotifyFont)}),s.showLibX.addEventListener("change",()=>{s.showLibX.checked?(localStorage.wmpotifyShowLibX=!0,delete document.body.dataset.hideLibx):(delete localStorage.wmpotifyShowLibX,document.body.dataset.hideLibx=!0,Spicetify.Platform.LocalStorageAPI.setItem("ylx-sidebar-state",1))}),y.querySelector("#wmpotify-config-close").addEventListener("click",qe),y.querySelector("#wmpotify-config-apply").addEventListener("click",dt);let i=Spicetify.Platform.PlatformData.os_version.split(".")[2]>=22e3;if(e&&(s.topmost.disabled=!1,s.topmost.value=localStorage.wmpotifyTopMost||"never",s.topmost.addEventListener("change",()=>{localStorage.wmpotifyTopMost=s.topmost.value,s.topmost.value==="always"||s.topmost.value==="minimode"&&z.isMiniMode()?m.setTopMost(!0):m.setTopMost(!1)}),s.lockTitle.disabled=!1,s.lockTitle.checked=localStorage.wmpotifyLockTitle,s.lockTitle.addEventListener("change",async()=>{if(m.lockTitle(s.lockTitle.checked),s.lockTitle.checked)m.setTitle(await Spicetify.AppTitle.get()),localStorage.wmpotifyLockTitle=!0;else{delete localStorage.wmpotifyLockTitle;let a=Spicetify.Player.data?.item.metadata;a&&Spicetify.Player.isPlaying()&&m.setTitle(a.artist_name+" - "+a.title)}}),i&&(s.backdrop.disabled=!1,s.backdrop.value=localStorage.wmpotifyBackdrop||"mica",s.backdrop.addEventListener("change",()=>{localStorage.wmpotifyBackdrop=s.backdrop.value,m.setBackdrop(s.backdrop.value)})),s.whMessage.style.display="none",s.whVer.textContent=", "+c.getString("CONF_ABOUT_CTEWH_VERSION",m.getModule().version),e.speedModSupported)){s.speed=y.querySelector("#wmpotify-config-speed"),s.speedValue=y.querySelector("#wmpotify-config-speed-value"),s.speed.addEventListener("pointerup",kt),y.querySelector("#wmpotify-config-speed-slow").addEventListener("click",ne.bind(null,.5)),y.querySelector("#wmpotify-config-speed-normal").addEventListener("click",ne.bind(null,1)),y.querySelector("#wmpotify-config-speed-fast").addEventListener("click",ne.bind(null,1.4));let a=e.playbackSpeed||1;s.speedValue.textContent=Number.isInteger(a)?a+".0":a,s.speedValue.addEventListener("click",async()=>{let l=await ke(c.CONF_SPEED_CUSTOM_DLG_TITLE,c.CONF_SPEED_CUSTOM_MSG,a.toString(),"1.0");l&&ne(l)})}i||(s.backdrop.style.display="none",s.backdrop.previousElementSibling.style.display="none"),navigator.userAgent.includes("Windows")||(s.topmost.style.display="none",s.topmost.previousElementSibling.style.display="none",s.lockTitle.style.display="none",s.lockTitle.nextElementSibling.style.display="none",s.whMessage.style.display="none"),s.hue.addEventListener("input",Fe),s.sat.addEventListener("input",Fe),s.tintPb.addEventListener("change",Fe),y.querySelector("#wmpotify-config-color-reset").addEventListener("click",Bt),y.querySelector("#wmpotify-config-prev").addEventListener("click",st),y.querySelector("#wmpotify-config-next").addEventListener("click",ct),lt.each(a=>{let l=document.createElement("option");l.textContent=a.name,l.value=a.name,a.name===(localStorage.wmpotifyFont||"Segoe UI")&&(l.selected=!0),a.name==="Segoe UI"?s.fontSelector.insertBefore(l,s.fontSelector.firstChild):s.fontSelector.insertBefore(l,s.fontCustom)}),localStorage.wmpotifyStyle&&(y.querySelector("#wmpotify-config-style").value=localStorage.wmpotifyStyle);let o=y.querySelector("#wmpotify-config-title-style");navigator.userAgent.includes("Windows")||o.querySelector("option[value=keepmenu]").remove(),navigator.userAgent.includes("Linux")&&o.querySelector("option[value=spotify]").remove(),localStorage.wmpotifyTitleStyle&&(o.value=localStorage.wmpotifyTitleStyle),localStorage.wmpotifyShowLibX&&(y.querySelector("#wmpotify-config-show-libx").checked=!0);let n=0,r=!1;s.topborder.addEventListener("pointerdown",function(){r=!0,n=y.getBoundingClientRect().bottom,document.body.style.cursor="ns-resize"},!0),document.addEventListener("pointerup",function(){r=!1,document.body.style.cursor="",localStorage.wmpotifyConfigHeight=y.style.height},!0),document.addEventListener("pointermove",function(a){r&&(y.style.height=n-a.clientY+"px")},!0),t.appendChild(y)}function xt(){if(W){if(document.body.dataset.wmpotifyLibPageOpen)Spicetify.Config.custom_apps.includes("wmpvis")?Spicetify.Platform.History.push({pathname:"/wmpvis"}):Spicetify.Platform.History.push({pathname:"/"});else if(y.style.display==="block"){qe();return}if(y.style.display="block",localStorage.wmpotifyTintColor){let[e,t,i]=localStorage.wmpotifyTintColor.split(",");s.hue.value=parseInt(e)+180,s.sat.value=parseInt(t)*121/100,i&&(s.tintPb.checked=!0)}}}function qe(){y.style.display="none"}function We(e){if(W){for(let t=0;t<W.length;t++){let i=W[t];i.style.display=t===e?"block":"none"}Re=e,s.title.textContent=W[e].dataset.tabTitle}}function st(){We((Re-1+W.length)%W.length)}function ct(){We((Re+1)%W.length)}function Fe(){let e=s.hue.value-180,t=s.sat.value*100/121;ie(e,t,s.tintPb.checked),localStorage.wmpotifyTintColor=e+","+t+","+(s.tintPb.checked?"1":"")}function Bt(){s.hue.value=180,s.sat.value=121,ie(),delete localStorage.wmpotifyTintColor}function kt(){s.speedValue.textContent=Number.isInteger(parseFloat(s.speed.value))?s.speed.value+".0":s.speed.value,we&&clearTimeout(we),we=setTimeout(()=>{ne(s.speed.value),we=null},500)}function ne(e){if(Spicetify.Platform.ConnectAPI.state.connectionStatus==="connected"){Spicetify.showNotification(c.CONF_SPEED_NO_CONNECT_MSG);return}e=parseFloat(e);let t=m.query().playbackSpeed||1;if(e!==t){s.speed.value=e,s.speedValue.textContent=Number.isInteger(e)?e+".0":e;try{m.setPlaybackSpeed(e)}catch(i){Spicetify.showNotification(i.message)}}}function dt(){let e=y.querySelector("#wmpotify-config-style").value,t=y.querySelector("#wmpotify-config-title-style").value,i=s.showLibX.checked;e!=="auto"?localStorage.wmpotifyStyle=e:delete localStorage.wmpotifyStyle,t!=="auto"?localStorage.wmpotifyTitleStyle=t:delete localStorage.wmpotifyTitleStyle,i?localStorage.wmpotifyShowLibX=!0:delete localStorage.wmpotifyShowLibX,location.reload()}var Ft={init:At,open:xt,close:qe,openTab:We,prevTab:st,nextTab:ct,apply:dt,isOpen:()=>y.style.display==="block"},ae=Ft;var ut=null;function Rt(){if(m.available())if(Ge()){let e=localStorage.wmpotifyPreMiniModeSize?.split(",");e&&e.length===2&&window.resizeTo(parseInt(e[0]),parseInt(e[1]))}else document.fullscreenElement&&document.exitFullscreen(),localStorage.wmpotifyPreMiniModeSize=[window.innerWidth,window.innerHeight],m.resizeTo(358,60)}function qt(){if(document.fullscreenElement)document.exitFullscreen(),Ee();else{if(Spicetify.Config.custom_apps.includes("wmpvis"))Spicetify.Platform.History.push({pathname:"/wmpvis"});else{let e=document.querySelector('.main-nowPlayingBar-extraControls button[data-testid="lyrics-button"]');e&&e.click()}ae.close(),document.documentElement.requestFullscreen(),document.body.classList.add("wmpotify-playerbar-visible"),setTimeout(()=>{document.addEventListener("pointermove",Ue),Ue()},200)}document.addEventListener("fullscreenchange",()=>{document.fullscreenElement||Ee()},{once:!0}),document.addEventListener("resize",()=>{Ee()},{once:!0})}function Ge(){let e=!!document.querySelector("#wmpotify-title-bar");return window.innerWidth<360&&window.innerHeight<(e?92:62)}function Ue(){if(!document.fullscreenElement){Ee();return}document.body.classList.add("wmpotify-playerbar-visible"),clearTimeout(ut),ut=setTimeout(()=>{document.body.classList.remove("wmpotify-playerbar-visible")},2e3)}function Ee(){document.body.classList.remove("wmpotify-playerbar-visible"),document.removeEventListener("pointermove",Ue)}window.addEventListener("resize",()=>{localStorage.wmpotifyTopMost==="minimode"&&m.setTopMost(Ge())});var Wt={toggleMiniMode:Rt,toggleFullscreen:qt,isMiniMode:Ge},z=Wt;var De,le,He,Ce,V,O,mt=null,re=!1;function St(){let e=document.querySelector(".main-nowPlayingBar-nowPlayingBar");De=document.querySelector(".player-controls__buttons button[data-testid='control-button-playpause']"),Spicetify.Player.addEventListener("onplaypause",se),new MutationObserver(se).observe(De,{attributes:!0,attributeFilter:["aria-label"]}),pt(),new MutationObserver(pt).observe(document.querySelector(".main-nowPlayingBar-left"),{childList:!0});let t=document.querySelector(".player-controls__left"),i=document.querySelector('.player-controls__buttons button[data-testid="control-button-skip-forward"]'),o=document.querySelector('.player-controls__buttons button[data-testid="control-button-repeat"]');t.appendChild(o);let n=m.query();n?.speedModSupported&&n.immediateSpeedChange&&(i.addEventListener("pointerdown",()=>{i.disabled||Spicetify.Platform.ConnectAPI.state.connectionStatus==="connected"||(mt=setTimeout(()=>{i.dataset.fastForward=!0,m.setPlaybackSpeed(5),Spicetify.Player.play()},1e3))}),i.addEventListener("click",g=>{clearTimeout(mt),i.dataset.fastForward&&(delete i.dataset.fastForward,m.setPlaybackSpeed(1),g.preventDefault(),g.stopPropagation())}));let r=document.createElement("button");r.setAttribute("aria-label","Stop"),r.id="wmpotify-stop-button",r.addEventListener("click",()=>{Spicetify.Platform.PlayerAPI.clearQueue(),Spicetify.Player.playUri("")}),t.appendChild(r);let a=document.querySelector(".player-controls__right"),l=document.querySelector(".volume-bar");le=l.querySelector(".volume-bar__icon-button"),He=l.querySelector(".progress-bar"),ft(),new MutationObserver(ft).observe(He,{attributes:!0,attributeFilter:["style"]}),a.appendChild(l);let d=document.querySelector(".volume-bar__slider-container"),u=d.children[0];d.addEventListener("click",()=>{if(window.innerWidth<750){u.dataset.visible=!0;let g=setTimeout(()=>{delete u.dataset.visible},5e3);u.addEventListener("pointerup",()=>{clearTimeout(g),setTimeout(()=>{delete u.dataset.visible},100)},{once:!0})}}),Ce=document.querySelectorAll(".playback-bar [class*=encore-text]");let p=document.createElement("div");p.classList.add("wmpotify-time-text-container"),O=document.createElement("span"),O.classList.add("wmpotify-time-text"),V=parseInt(localStorage.wmpotifyTimeTextMode||0),yt(),O.dataset.mode=V,O.addEventListener("click",()=>{V=(V+1)%3,O.dataset.mode=V,localStorage.wmpotifyTimeTextMode=V}),p.appendChild(O),e.insertAdjacentElement("afterbegin",p),Spicetify.Player.addEventListener("onprogress",yt);let f=document.querySelector("#wmpotify-title-bar"),h=document.querySelector("#wmpotify-title-buttons");if(f&&(I(),window.addEventListener("resize",I)),n){let g=new Spicetify.Playbar.Button(c.PB_BTN_MINI_MODE,"",()=>z.toggleMiniMode());g.element.id="wmpotify-mini-mode-button"}let L=new Spicetify.Playbar.Button(c.PB_BTN_FULLSCREEN,"",()=>z.toggleFullscreen());L.element.id="wmpotify-fullscreen-button";function I(){window.innerWidth<800?f.contains(O)||(h?f.insertBefore(O,h):f.appendChild(O)):e.contains(O)||p.appendChild(O)}}async function pt(){se();let e=!!document.querySelector("#wmpotify-title-bar"),t=m.available(),i=await Spicetify.AppTitle.get(),o=document.querySelector("#wmpotify-title-text"),n=document.querySelector(".main-nowPlayingWidget-trackInfo");if(!n||document.querySelector(".wmpotify-track-info"))return;let r=document.createElement("p");r.classList.add("wmpotify-track-info"),r.textContent=document.querySelector(".main-trackInfo-name")?.textContent||"",n.appendChild(r),window.innerWidth<420&&window.innerHeight<(e?92:62)&&(e?o.textContent=r.textContent:t&&m.setTitle(r.textContent),re=!0);let a=1;setInterval(()=>{if(!Spicetify.Player.isPlaying())return;let l=Spicetify.Player.data?.item.metadata;l&&(a===0?r.textContent=l.title:a===1?r.textContent=l.artist_name:a===2&&(r.textContent=l.album_title),a=(a+1)%3,window.innerWidth<420&&window.innerHeight<(e?92:62)?(e?o.textContent=r.textContent:t&&(m.lockTitle(!0),m.setTitle(r.textContent)),re=!0):re&&(re=!1,e&&(o.textContent=i),localStorage.wmpotifyLockTitle||m.lockTitle(!1),Spicetify.Player.isPlaying()&&!localStorage.wmpotifyLockTitle?m.setTitle(l.artist_name+" - "+l.title):m.setTitle(i)))},3e3),Spicetify.Player.addEventListener("songchange",()=>{a=0,r.textContent=Spicetify.Player.data?.item.metadata.title,window.innerWidth<420&&window.innerHeight<(e?92:62)&&(e?o.textContent=r.textContent:t&&m.setTitle(r.textContent),re=!0)})}function se(){De?.classList.toggle("playing",Spicetify.Player.isPlaying());let e=document.querySelector(`.playlist-playlist-playlist[data-test-uri="${Spicetify.Player.data?.context?.uri}"]`);e&&e.classList.toggle("playing",Spicetify.Player.isPlaying())}function ft(){let e=getComputedStyle(He).getPropertyValue("--progress-bar-transform").replace("%","")/100;e===0?le.dataset.vol="muted":e<=.3?le.dataset.vol="low":e<=.6?le.dataset.vol="mid":le.dataset.vol="high"}function yt(){switch(V){case 0:{let e=Spicetify.Player.data?.item?.metadata?.duration-Spicetify.Player.getProgress();O.textContent=ge(e,!0)}break;case 1:{let e=Ce[0].textContent;(e.length===4||e.length===7)&&(e="0"+e),O.textContent=e}break;case 2:{let e=Ce[0].textContent;(e.length===4||e.length===7)&&(e="0"+e);let t=Ce[1].textContent;(t.length===4||t.length===7)&&(t="0"+t),O.textContent=`${e} / ${t}`}break}}var ce=new MutationObserver(de),Ut=new ResizeObserver(de.bind(null,!0)),Gt={init(){ce.observe(document.documentElement,{attributes:!0,attributeFilter:["style"]}),Ut.observe(document.querySelector(".Root__right-sidebar")),window.addEventListener("resize",de),window.addEventListener("load",de)},updateSidebarWidth:de};function de(e){if(!Spicetify.Platform.History.location.pathname.startsWith("/wmpotify-standalone-libx")&&!e){let o=getComputedStyle(document.documentElement).getPropertyValue("--right-sidebar-width");o&&(ce.disconnect(),document.documentElement.style.setProperty("--panel-width",o),ce.observe(document.documentElement,{attributes:!0,attributeFilter:["style"]}));return}ce.disconnect();let t=document.querySelector(".Root__right-sidebar aside");document.documentElement.style.setProperty("--panel-width",t?t.offsetWidth:8),getComputedStyle(document.documentElement).getPropertyValue("--right-sidebar-width")&&document.documentElement.style.setProperty("--right-sidebar-width",t?t.offsetWidth:8),ce.observe(document.documentElement,{attributes:!0,attributeFilter:["style"]})}var _e=Gt;var ze;function Le(){console.log("WMPotify: Trying to initialize queue panel");let e=document.querySelector(".Root__right-sidebar > div > div > div:has(aside)");if(e&&!ze&&(ze=new MutationObserver(Le),ze.observe(e,{childList:!0})),!document.querySelector("#queue-panel")||document.querySelector("#wmpotify-queue-toolbar")||document.querySelectorAll('div[data-encore-id="tabPanel"]').length>2)return;let t=document.querySelector("#Desktop_PanelContainer_Id");t.classList.add("spotify-queue-panel");let i=document.querySelector("#Desktop_PanelContainer_Id > div > div:first-child > div:first-child"),o=document.querySelector("#Desktop_PanelContainer_Id > div > div:nth-child(2)");o.id="spotify-queue-panel-content";let n=document.createElement("div");n.id="wmpotify-queue-toolbar";let r=document.createElement("button");r.id="wmpotify-queue-playlist-button",r.classList.add("wmpotify-toolbar-button"),r.addEventListener("click",()=>{let g=Spicetify.Player.data?.context?.uri;g&&window.open(g)}),r.textContent=document.querySelector('#queue-panel div[data-flip-id*="section-header-"] a')?.textContent||c.QUEUE_CURRENT_PLAYLIST_PLACEHOLDER,r.innerHTML+='<span class="expandMark">\u23F7</span>',n.appendChild(r);let a=document.createElement("button");a.id="wmpotify-queue-clear-button",a.classList.add("wmpotify-toolbar-button"),a.addEventListener("click",()=>{Spicetify.Platform.PlayerAPI.clearQueue(),Spicetify.Player.playUri("")}),n.appendChild(a),o.insertAdjacentElement("afterbegin",n);let l=getComputedStyle(document.documentElement).getPropertyValue("--album-art-placeholder").trim().slice(5,-2),d=document.createElement("div");d.id="wmpotify-queue-npv";let u=document.createElement("img");u.id="wmpotify-queue-album-art",u.src=document.querySelector(".main-nowPlayingWidget-coverArt .cover-art img")?.src||l,d.appendChild(u);let p=document.createElement("div");p.id="wmpotify-queue-song-title",p.textContent=document.querySelector(".main-trackInfo-name")?.textContent||"No items",d.appendChild(p),i.insertAdjacentElement("afterbegin",d),ht(),new MutationObserver(ht).observe(document.querySelector("#queue-panel"),{childList:!0});let f=document.querySelectorAll('#Desktop_PanelContainer_Id div[role="tablist"] button'),h=[],L;for(let g of f)h.push({text:g.textContent,click:function(){for(let w of L.menuItems)w.classList.remove("activeStyle");this.classList.add("activeStyle"),g.click()}});h[0].classList=["activeStyle"],document.querySelector("#wmpotifyQueueTabMenuBg")?.remove(),L=he("wmpotifyQueueTab",h);let I=new j(["wmpotifyQueueTab"]);t.addEventListener("contextmenu",g=>{g.preventDefault(),I.openMenu("wmpotifyQueueTab",{left:g.clientX+"px",top:g.clientY+"px"})}),Spicetify.Player.addEventListener("songchange",()=>{r.textContent=Spicetify.Player.data?.context?.metadata?.context_description||"Now Playing",r.innerHTML+='<span class="expandMark">\u23F7</span>',u.src=Spicetify.Player.data?.item?.album?.images?.[0]?.url?.replace("spotify:image:","https://i.scdn.co/image/")||l,p.textContent=Spicetify.Player.data?.item?.name||"No items"})}function ht(){let e=document.querySelectorAll("#queue-panel ul")[1];e&&(bt(),new MutationObserver(bt).observe(e,{childList:!0}))}function bt(){if(!document.querySelector("#queue-panel")||!Spicetify.Queue)return;let e=document.querySelectorAll("#queue-panel li .HeaderArea");for(let t=0;t<e.length;t++){let i=e[t];if(i.querySelector(".wmpotify-queue-duration"))continue;let o=t===0?Spicetify.Queue.track?.contextTrack?.metadata?.duration:Spicetify.Queue.nextTracks?.[t-1]?.contextTrack?.metadata?.duration;if(!o)continue;let n=document.createElement("span");n.classList.add("wmpotify-queue-duration"),n.textContent=ge(o),i.appendChild(n)}}var Dt={getItem(e){let t=Spicetify._platform?.initialUser?.username,i=localStorage.getItem(t+":"+e);return isNaN(i)?i:parseFloat(i)},setItem(e,t){let i=Spicetify._platform?.initialUser?.username;localStorage.setItem(i+":"+e,t)},removeItem(e){let t=Spicetify._platform?.initialUser?.username;localStorage.removeItem(t+":"+e)}},k=Dt;var _,A=[],P={},F=new MutationObserver(Ye),gt=new MutationObserver(zt),x=!1,Ke=!1,Ve=[],$e=[],Ht={async init(){if(document.querySelector("#wmpotify-libx-sidebar"))return!1;Object.keys(Spicetify.Platform.Translations).filter(o=>o.startsWith("shared.library.filter.")).forEach(o=>{let n=Spicetify.Platform.Translations[o];P[o.split(".").pop()]={loc_id:o,value:n}}),A.length===0&&(A.push({identifier:"playlist",localized:P.playlist.value,elem:null}),A.push({identifier:"album",localized:P.album.value,elem:null}),A.push({identifier:"artist",localized:P.artist.value,elem:null}));let t=document.createElement("div");t.id="wmpotify-libx-header",document.querySelector(".main-yourLibraryX-libraryContainer").insertAdjacentElement("afterbegin",t);let i=document.createElement("div");return i.id="wmpotify-libx-sidebar",document.querySelector(".main-yourLibraryX-libraryItemContainer").insertAdjacentElement("afterbegin",i),await $t(),_=document.querySelector('.main-yourLibraryX-filterArea .search-searchCategory-categoryGrid [role="presentation"]'),Ye(),F.observe(_,{childList:!0}),gt.observe(document.querySelector(".main-yourLibraryX-filterArea"),{childList:!0}),window.addEventListener("resize",wt),!0},uninit(){document.querySelector("#wmpotify-libx-header")?.remove(),document.querySelector("#wmpotify-libx-sidebar")?.remove(),F.disconnect(),gt.disconnect(),window.removeEventListener("resize",wt)},go(e){e||(e=Spicetify.Platform.History.location.pathname.split("/").slice(2)),e[0]!==void 0&&Vt(e)}};function Xe(){let e=document.querySelector("#wmpotify-libx-header");e.innerHTML="";let t=document.createElement("div");t.classList.add("wmpotify-libx-header-root-icon"),t.classList.add("wmpotify-toolbar-button"),e.appendChild(t);let i=document.createElement("button");i.classList.add("wmpotify-libx-header-root-text"),i.classList.add("wmpotify-toolbar-button"),i.textContent=c.LIBX_HEADER_ROOT,i.addEventListener("click",X),e.appendChild(i);let o=je();if(o.forEach((n,r)=>{let a=document.createElement("button");a.classList.add("wmpotify-libx-header-category-text"),a.classList.add("wmpotify-toolbar-button"),a.textContent=n,a.addEventListener("click",async()=>{if(!a.nextElementSibling)return;x&&(ue(),await me()),F.disconnect();let l=A.find(d=>d.localized===n);if(r===0)X(),await U();else{if(!l)return;let d=A.find(u=>u.localized===o[r-1]);(!Et(d)||!document.contains(l.elem))&&(Z()||(X(),await U()),d.elem.click(),await U())}$(l),l.elem.click(),F.observe(_,{childList:!0})}),e.appendChild(a)}),x){let n=document.querySelector(".main-yourLibraryX-collapseButton > div").textContent,r=document.createElement("button");r.classList.add("wmpotify-libx-header-category-text"),r.classList.add("wmpotify-toolbar-button"),r.textContent=n,e.appendChild(r)}}function Ye(){x=document.querySelector(".main-yourLibraryX-collapseButton").childElementCount>1;let e=je(!0);if(x){let o=Spicetify.Platform.LocalStorageAPI.getItem("opened-folder-uri");e.push(o)}if(!Ke){let o="/wmpotify-standalone-libx/"+e.join("/");Spicetify.Platform.History.location.pathname==="/wmpotify-standalone-libx"?Spicetify.Platform.History.location.pathname=o:Spicetify.Platform.History.location.pathname!==o&&Spicetify.Platform.History.push({pathname:"/wmpotify-standalone-libx/"+e.join("/")})}if(x){Xe();return}let t=!_.querySelector('button[class*="ChipClear"]:first-child'),i=Array.from(_.querySelectorAll("button"));if(t)i.forEach((o,n)=>{let r={};r.localized=o.textContent,r.identifier=Object.keys(P).find(a=>P[a].value===r.localized),r.elem=o,A.some(a=>a.localized===r.localized)||A.push(r)});else{i.shift();let o=i[0].textContent,n=A.find(r=>r.localized===o);if(!n){let r={};r.localized=o,r.identifier=Object.keys(P).find(a=>P[a].value===r.localized),r.elem=i[0],A.push(r),n=r}n.children||(n.children=[]),i.shift(),i.forEach((r,a)=>{let l={};l.localized=r.textContent,l.identifier=Object.keys(P).find(d=>P[d].value===l.localized),l.elem=r,n.children.some(d=>d.localized===l.localized)||n.children.push(l)})}Xe(),Ct()}function zt(){F.disconnect(),_=document.querySelector('.main-yourLibraryX-filterArea .search-searchCategory-categoryGrid [role="presentation"]'),Ye(),F.observe(_,{childList:!0})}function $(e){if(!document.contains(e.elem)){for(let t of _.querySelectorAll("button"))if(t.textContent===e.localized){e.elem=t;break}}}function Z(){return!_.querySelector('button[class*="ChipClear"]:first-child')}function Et(e){return Z()?!1:Array.from(_.querySelectorAll("button"))[1].textContent===e.localized}async function X(){x&&(ue(),await me()),_.querySelector('button[class*="ChipClear"]:first-child')?.click()}function ue(){Ke=!0,document.querySelectorAll(".main-yourLibraryX-collapseButton button")?.[1]?.click()}function je(e=!1){let t=[];if(x=document.querySelector(".main-yourLibraryX-collapseButton").childElementCount>1,x)return e?$e:Ve;if(Z())return Ve=[],$e=[],t;{let o=Array.from(_.querySelectorAll("button")).slice(1)[0].textContent;e&&(o=Object.keys(P).find(r=>P[r].value===o)),t.push(o);let n=_.querySelector('button[class*="secondary-selected"]');n&&(e?t.push(Object.keys(P).find(r=>P[r].value===n.textContent)):t.push(n.textContent)),e?$e=structuredClone(t):Ve=structuredClone(t)}return t}async function Vt(e){if(x&&(ue(),await me()),F.disconnect(),!Z()){if(X(),e.length===0)return;await U()}for(let t=0;t<e.length;t++)if(e[t].startsWith("spotify:user:"))await Xt(),document.querySelector('.main-yourLibraryX-libraryRootlist .main-rootlist-wrapper div[role="button"][aria-labelledby*="listrow-title-'+e[t]+'"]').click();else if(t===0){let i=A.find(o=>o.identifier===e[t]);if(!i)return;$(i),i.elem.click(),await U()}else{let i=A.find(n=>n.identifier===e[t-1]);if(!i)return;let o=i.children.find(n=>n.identifier===e[t]);if(!o)return;$(o),o.elem.click(),await U()}Xe(),Ct(),F.observe(_,{childList:!0})}function Ct(){let e=document.querySelector("#wmpotify-libx-sidebar");e.innerHTML="";let t=document.createElement("div");t.classList.add("wmpotify-libx-sidebar-item-container");let i=document.createElement("button");i.classList.add("wmpotify-libx-sidebar-item"),i.id="wmpotify-libx-sidebar-root",i.textContent=c.LIBX_SIDEBAR_ROOT,i.addEventListener("click",X);let o=document.createElement("div");o.classList.add("wmpotify-libx-sidebar-chevron"),o.addEventListener("click",()=>{e.classList.toggle("rootCollapsed")}),t.appendChild(o),t.appendChild(i),e.appendChild(t),A.forEach(r=>{let a=document.createElement("div");a.classList.add("wmpotify-libx-sidebar-item-container");let l=document.createElement("button");if(l.classList.add("wmpotify-libx-sidebar-item"),l.textContent=r.localized,l.dataset.identifier=r.identifier,l.addEventListener("click",async()=>{l.classList.contains("active")&&!x||(x&&(ue(),await me()),F.disconnect(),Z()||(X(),await U()),$(r),r.elem.click(),F.observe(_,{childList:!0}))}),a.appendChild(l),e.appendChild(a),r.children&&r.children.length>0){let d=document.createElement("div");d.classList.add("wmpotify-libx-sidebar-chevron"),d.addEventListener("click",()=>{a.classList.toggle("collapsed")}),a.insertBefore(d,l);let u=document.createElement("div");u.classList.add("wmpotify-libx-sidebar-downlevel"),r.children.forEach(p=>{let f=document.createElement("button");f.classList.add("wmpotify-libx-sidebar-item"),f.textContent=p.localized,f.dataset.identifier=p.identifier,f.addEventListener("click",async()=>{f.classList.contains("active")&&!x||(x&&(ue(),await me()),F.disconnect(),$(p),(!Et(r)||!document.contains(p.elem))&&(Z()||(X(),await U()),$(r),r.elem.click(),await U()),$(p),p.elem.click(),F.observe(_,{childList:!0}))}),u.appendChild(f)}),e.appendChild(u)}});let n=je();if(n.length>0){let r=n.pop();Array.from(e.querySelectorAll(".wmpotify-libx-sidebar-item")).find(l=>l.textContent===r).classList.add("active")}else i.classList.add("active")}function wt(){let e=k.getItem("ylx-sidebar-state");Spicetify.Platform.LocalStorageAPI.setItem("ylx-sidebar-state",2),k.setItem("ylx-sidebar-state",e)}function $t(){if(!document.querySelector('.main-yourLibraryX-filterArea .search-searchCategory-categoryGrid [role="presentation"]'))return new Promise(e=>{let t=new MutationObserver(()=>{document.querySelector('.main-yourLibraryX-filterArea .search-searchCategory-categoryGrid [role="presentation"]')&&(e(),t.disconnect())});t.observe(document.querySelector(".main-yourLibraryX-libraryItemContainer"),{childList:!0,subtree:!0})})}function U(){return new Promise(e=>{let t=new MutationObserver(()=>{_.querySelector("button")&&(e(),t.disconnect())});t.observe(_,{childList:!0})})}function me(){return new Promise(e=>{let t=new MutationObserver(()=>{Ke=!1,e(),t.disconnect()});t.observe(document.querySelector(".main-yourLibraryX-filterArea"),{childList:!0})})}function Xt(){if(!document.querySelector('.main-yourLibraryX-libraryRootlist .main-rootlist-wrapper [role="presentation"]:not([class])'))return new Promise(e=>{let t=new MutationObserver(()=>{document.querySelector('.main-yourLibraryX-libraryRootlist .main-rootlist-wrapper [role="presentation"]:not([class])')&&(e(),t.disconnect())});t.observe(document.querySelector(".main-yourLibraryX-libraryRootlist"),{childList:!0,subtree:!0})})}var ve=Ht;async function Te(e){let t=document.querySelector('section[data-testid="artist-page"]');if(!t){e&&(await Me.waitForPageRender(),Te(!1));return}if(await Kt(t),document.querySelector(".main-topBar-topbarContent").appendChild(document.querySelector(".artist-artistDiscography-topBar")),t.querySelector(".artist-artistDiscography-cardGrid"))return;let i=document.querySelector(".main-topBar-topbarContent .artist-artistDiscography-topBar a").textContent,o=t.dataset.testUri,n=t.querySelectorAll(".artist-artistDiscography-headerContainer");for(let l of n){if(l.querySelector(".artist-artistDiscography-headerTitle + div a"))continue;let d=l.querySelector(".main-entityHeader-image");if(!d)continue;d.addEventListener("dblclick",()=>{l.querySelector(".artist-artistDiscography-headerButtons div button").click()}),d.addEventListener("contextmenu",async p=>{l.querySelector(".artist-artistDiscography-headerButtons > button:last-child").click(),p.preventDefault(),p.stopPropagation(),await Yt();let f=document.querySelector("[data-tippy-root]");f.dataset.wmpotifyForceTransform=!0,f.style.setProperty("--tippy-force-transform",`translate(${p.clientX}px, ${p.clientY}px)`)});let u=document.createElement("a");u.href=o,u.textContent=i,l.querySelector(".artist-artistDiscography-headerTitle + div").appendChild(u)}let r=t.querySelectorAll(".artist-artistDiscography-tracklist");for(let l of r){if(l.querySelector(".wmpotify-discography-trackList-header"))continue;let d=l.querySelector('[role="grid"]');if(!d)continue;let u=d.getAttribute("aria-label"),p=document.createElement("div");p.className="wmpotify-discography-trackList-header",p.textContent=u,l.insertAdjacentElement("afterbegin",p)}let a=new MutationObserver(()=>{Te(!1),a.disconnect()});a.observe(t.querySelector('[data-testid="infinite-scroll-list"]'),{childList:!0})}function Kt(e){if(!e.querySelector(".artist-artistDiscography-tracklist"))return new Promise(t=>{let i=new MutationObserver(()=>{e.querySelector(".artist-artistDiscography-tracklist")&&(i.disconnect(),t())});i.observe(e,{childList:!0,subtree:!0})})}function Yt(){return new Promise(e=>{let t=new MutationObserver(()=>{document.querySelector("[data-tippy-root]")&&(t.disconnect(),e())});t.observe(document.body,{childList:!0})})}async function Qe(e){let t=document.querySelector("main > [role=presentation]");if(!t){e&&(await jt(),Qe(!1));return}await Qt(t),console.log("Initializing playlist page");let i=t.querySelector(".main-actionBar-ActionBarRow > div:last-child"),o=document.querySelector(".main-topBar-topbarContent");if(!i||!o)return;i.id="playlist-search-box-container";let n=i.parentElement;new MutationObserver(r=>{for(let a of r)if(a.type==="attributes"&&a.attributeName==="class"){let l=a.target;l.classList.contains("main-entityHeader-topbarContentFadeIn")?l.appendChild(i):n.appendChild(i)}}).observe(o,{attributes:!0,attributeFilter:["class"]})}function jt(){return new Promise(e=>{let t=new MutationObserver(()=>{document.querySelector(".main-loadingPage-container")||document.querySelector("main > [role=presentation]")&&(e(),t.disconnect())});t.observe(document.querySelector(".main-view-container__scroll-node-child main"),{childList:!0})})}function Qt(e){if(!e.querySelector(".main-actionBar-ActionBarRow")||!document.querySelector(".main-topBar-topbarContent"))return new Promise(t=>{let i=new MutationObserver(()=>{e.querySelector(".main-actionBar-ActionBarRow")&&document.querySelector(".main-topBar-topbarContent")&&(i.disconnect(),t())});i.observe(e,{childList:!0,subtree:!0})})}var Je=0,Oe={waitForPageRender(){return new Promise(e=>{let t=new MutationObserver(()=>{document.querySelector(".main-loadingPage-container")||(e(),t.disconnect())});t.observe(document.querySelector(".main-view-container__scroll-node-child main"),{childList:!0})})},async handleLocChange(e){if(e?.pathname&&!(Je&&Date.now()-Je<2e3)){if(document.documentElement.dataset.page=e.pathname,_e.updateSidebarWidth(),e.pathname.startsWith("/wmpotify-standalone-libx")){document.body.dataset.wmpotifyLibPageOpen=!0;let t=k.getItem("ylx-sidebar-state"),i=k.getItem("ylx-expanded-state-nav-bar-width");Spicetify.Platform.LocalStorageAPI.setItem("ylx-sidebar-state",2),Spicetify.Platform.LocalStorageAPI.setItem("ylx-expanded-state-nav-bar-width",0),k.setItem("ylx-sidebar-state",t),k.setItem("ylx-expanded-state-nav-bar-width",i),await ve.init()||Spicetify.Platform.History.action==="POP"&&ve.go()}else if(document.body.dataset.wmpotifyLibPageOpen)if(delete document.body.dataset.wmpotifyLibPageOpen,ve.uninit(),localStorage.wmpotifyShowLibX){let t=k.getItem("ylx-sidebar-state");k.removeItem("ylx-sidebar-state");let i=k.getItem("ylx-expanded-state-nav-bar-width");k.removeItem("ylx-expanded-state-nav-bar-width"),Spicetify.Platform.LocalStorageAPI.setItem("ylx-sidebar-state",parseInt(t)),Spicetify.Platform.LocalStorageAPI.setItem("ylx-expanded-state-nav-bar-width",parseInt(i))}else Spicetify.Platform.LocalStorageAPI.setItem("ylx-sidebar-state",1);e.pathname.match("/artist/.*/discography/.*")?Te(!0):e.pathname.startsWith("/playlist/")&&(document.querySelector(".playlist-playlist-playlist")||await Oe.waitForPageRender(),se()),Qe(!0)}},init(){Oe.handleLocChange(Spicetify.Platform.History.location),Je=Date.now(),Spicetify.Platform.History.listen(e=>Oe.handleLocChange(e))}},Me=Oe;var _t=[".Root__globalNav",".main-globalNav-historyButtons",".main-globalNav-searchSection",".main-globalNav-searchContainer > button",".main-globalNav-searchContainer div form button",'.main-globalNav-searchContainer div form input[type="search"]',".main-topBar-topbarContentRight > .main-actionButtons > button",".main-topBar-topbarContentRight > button:last-child",".Root__main-view",".main-view-container__scroll-node-child main",".main-nowPlayingBar-nowPlayingBar",".player-controls__left",'.player-controls__buttons button[data-testid="control-button-repeat"]','.player-controls__buttons button[data-testid="control-button-playpause"]',".player-controls__right",".playback-bar [class*=encore-text]",".volume-bar",".volume-bar__icon-button",".volume-bar .progress-bar",".main-nowPlayingBar-left"],ee="xp",B="spotify";function Jt(){localStorage.wmpotifyShowLibX||(document.body.dataset.hideLibx=!0),m.init();let e=m.query();switch(e&&(localStorage.wmpotifyTopMost==="always"||localStorage.wmpotifyTopMost==="minimode"&&z.isMiniMode()?m.setTopMost(!0):m.setTopMost(!1)),localStorage.wmpotifyTitleStyle&&["native","custom","spotify","keepmenu"].includes(localStorage.wmpotifyTitleStyle)?B=localStorage.wmpotifyTitleStyle:(console.log("WMPotify EarlyInit:",window.SpotEx,e),window.outerHeight-window.innerHeight>0||e?.options?.showframe||navigator.userAgent.includes("Linux")?B="native":(window.SpotEx||e)&&(e?.options?.showmenu&&!e.options.showcontrols?B="keepmenu":B="custom")),B==="keepmenu"&&!navigator.userAgent.includes("Windows")&&(B="spotify"),B==="spotify"&&navigator.userAgent.includes("Linux")&&(B="native"),document.documentElement.dataset.wmpotifyTitleStyle=B,e&&!localStorage.wmpotifyStyle&&B==="native"&&e.isThemingEnabled&&(e.options.transparentrendering&&e.isDwmEnabled?ee="aero":e.isDwmEnabled||(ee="basic")),localStorage.wmpotifyStyle&&["xp","aero","basic"].includes(localStorage.wmpotifyStyle)&&(ee=localStorage.wmpotifyStyle),m.setMinSize(358,B==="native"?60:90),ee){case"xp":m.extendFrame(0,0,0,0);break;case"aero":m.extendFrame(0,0,0,60);break;case"basic":m.extendFrame(0,0,0,0),document.hasFocus()?document.body.style.backgroundColor="#b9d1ea":document.body.style.backgroundColor="#d7e4f2",window.addEventListener("focus",()=>{document.body.style.backgroundColor="#b9d1ea"}),window.addEventListener("blur",()=>{document.body.style.backgroundColor="#d7e4f2"});break}document.documentElement.dataset.wmpotifyStyle=ee,window.addEventListener("resize",()=>{ee==="aero"&&(window.innerHeight<62?m.extendFrame(-1,-1,-1,-1):m.extendFrame(0,0,0,60)),m.setMinSize(358,B==="native"?60:90)}),localStorage.wmpotifyFont&&document.documentElement.style.setProperty("--ui-font",localStorage.wmpotifyFont),e&&localStorage.wmpotifyLockTitle&&m.lockTitle(!0)}Jt();async function Zt(){if(await nt(B),m.available()&&localStorage.wmpotifyLockTitle&&m.setTitle(await Spicetify.AppTitle.get()),localStorage.wmpotifyShowLibX||Spicetify.Platform.LocalStorageAPI.setItem("ylx-sidebar-state",1),Spicetify.Platform.PlatformData.os_version?.split(".")[2]>=22e3&&localStorage.wmpotifyBackdrop!=="none"&&m.setBackdrop(localStorage.wmpotifyBackdrop||"mica"),localStorage.wmpotifyTintColor){let[t,i,o]=localStorage.wmpotifyTintColor.split(",");ie(t,i,o)}Y.init(),Me.init(),_e.init(),ae.init(),new Spicetify.Menu.Item(c.MENU_CONF,!1,ae.open).register(),at(),St(),Le(),new MutationObserver(Le).observe(document.querySelector(".XOawmCGZcQx4cesyNfVO")||document.querySelector(".Root__right-sidebar > div > div[class]:first-child")||document.querySelector(".Root__right-sidebar div[class]"),{childList:!0})}function eo(){return window.Spicetify?.Platform?.PlayerAPI&&window.Spicetify.AppTitle&&window.Spicetify.Player?.origin?._state&&window.Spicetify.Menu&&window.Spicetify.Platform.History?.listen&&window.Spicetify.Platform.LocalStorageAPI&&window.Spicetify.Platform.Translations&&window.Spicetify.Platform.PlatformData&&_t.every(e=>document.querySelector(e))}window.addEventListener("load",()=>{let e=0,t=setInterval(async()=>{if(eo()){clearInterval(t);try{await Zt()}catch(i){(window.Spicetify?.showNotification||window.alert)("[WMPotify] "+c.MAIN_MSG_ERROR_INIT),console.error("WMPotify: Error during init:",i)}console.log("WMPotify: Theme loaded")}else if(e++>80){(window.Spicetify?.showNotification||window.alert)("[WMPotify] "+c.MAIN_MSG_ERROR_LOAD_FAIL),clearInterval(t);let i=[];for(let o of _t)document.querySelector(o)||i.push(o);console.log("WMPotify: Missing elements:",i)}},100)});document.addEventListener("scroll",function(){document.documentElement.scrollTo(0,0)});})();
