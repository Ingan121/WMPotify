(()=>{var w=class{constructor(a=[],n=[]){this.menuOrder=a,this.submenus=n,this.openedMenu=null,this.mouseOverMenu=!1,this.mouseOverSubmenu=!1,this.handlingPointerEvent=!1,this.handlingKeyEvent=!1,this.boundMenuNavigationHandler=this.menuNavigationHandler.bind(this),this.submenuOpenTimer=null,this.submenuCloseTimer=null,this.shouldNotCloseSubmenu=!1,this.menuHierarchy={},this.beforeMenuOpenEvent=new Event("beforemenuopen"),this.afterMenuCloseEvent=new Event("aftermenuclose");for(let e of a){this.menuHierarchy[e]=[];let t=document.getElementById(e+"MenuBg"),i=t.querySelectorAll(".contextMenuItem");for(let o of i)o.dataset.submenu&&this.menuHierarchy[e].push(o.dataset.submenu),o.addEventListener("pointerover",()=>{for(let u of i)delete u.dataset.active;o.dataset.active=!0,clearTimeout(this.submenuOpenTimer),o.dataset.submenu?this.submenuOpenTimer=setTimeout(()=>{this.openMenu(o.dataset.submenu)},300):this.menuHierarchy[e].length>0&&this.delayedCloseMenu(this.menuHierarchy[e][0])}),o.addEventListener("pointerleave",()=>{this.mouseOverSubmenu||(delete o.dataset.active,clearTimeout(this.submenuOpenTimer),o.dataset.submenu&&this.delayedCloseMenu(o.dataset.submenu))}),o.addEventListener("click",()=>{o.dataset.submenu&&!o.classList.contains("disabled")?this.openedMenu.id!==o.dataset.submenu+"MenuBg"?this.openMenu(o.dataset.submenu):document.getElementById(o.dataset.submenu+"MenuBg").focus():o.dataset.noClose||this.closeMenu(e)});t.addEventListener("focusout",o=>{top.ignoreFocusLoss||o.relatedTarget&&o.relatedTarget.dataset.submenuOf===e||this.closeMenu(e)}),t.addEventListener("pointermove",o=>{(o.clientX>0||o.clientY>0)&&(t.style.animation="none")})}for(let e of n){let t=document.getElementById(e+"MenuBg"),i=t.querySelectorAll(".contextMenuItem"),o=document.getElementById(t.dataset.submenuOf+"MenuBg"),u=Array.from(o.querySelectorAll(".contextMenuItem")).findIndex(s=>s.dataset.submenu===e),c=o.querySelectorAll(".contextMenuItem")[u];for(let s of i)s.addEventListener("pointerover",()=>{for(let y of i)delete y.dataset.active;s.dataset.active=!0}),s.addEventListener("pointerleave",()=>{delete s.dataset.active}),s.addEventListener("click",()=>{this.shouldNotCloseSubmenu=!1,this.closeMenu(e),this.closeMenu(t.dataset.submenuOf)});t.addEventListener("pointerover",()=>{this.mouseOverMenu=!0,this.mouseOverSubmenu=!0,this.shouldNotCloseSubmenu=!0,clearTimeout(this.submenuCloseTimer),c.dataset.active=!0}),t.addEventListener("pointerleave",()=>{this.mouseOverMenu=!1,this.mouseOverSubmenu=!1,this.shouldNotCloseSubmenu=!1}),t.addEventListener("focusout",s=>{if(top.ignoreFocusLoss||t.style.display==="none")return;this.shouldNotCloseSubmenu=!1;let y=!!t.dataset.openStandalone;s.relatedTarget&&s.relatedTarget.id&&s.relatedTarget.id===o.id||(this.closeMenu(e),!(s.relatedTarget&&s.relatedTarget.id&&s.relatedTarget.dataset.submenuOf===t.dataset.submenuOf)&&(y||this.closeMenu(t.dataset.submenuOf)))})}}openMenu(a,n){let e=document.getElementById(a+"MenuBg"),t=document.getElementById(a+"Menu"),i=!!e.dataset.submenuOf,o,u,c,s=e.querySelectorAll(".contextMenuItem.debug");if(localStorage.wmpotifyDebugMode){c=e.querySelectorAll(".contextMenuItem:not([data-hidden])");for(let d of s)d.style.display=""}else{c=e.querySelectorAll(".contextMenuItem:not([data-hidden]):not(.debug)");for(let d of s)d.style.display="none"}if(e.dispatchEvent(this.beforeMenuOpenEvent),n)e.dataset.openStandalone=!0;else{if(i){if(this.menuHierarchy[e.dataset.submenuOf].length>1)for(let h of this.menuHierarchy[e.dataset.submenuOf])h!==a&&this.closeMenu(h);if(o=document.getElementById(e.dataset.submenuOf+"MenuBg"),o.style.display==="none")return;let d=Array.from(o.querySelectorAll(".contextMenuItem")).findIndex(h=>h.dataset.submenu===a);if(u=o.querySelectorAll(".contextMenuItem")[d],u.classList.contains("disabled"))return}else for(let d of this.menuOrder)d!==a&&document.getElementById(d+"MenuBg").style.display==="block"&&this.closeMenu(d);delete e.dataset.openStandalone}e.style.animation="";for(let d of c)delete d.dataset.active;if(n)n.top&&(e.style.top=n.top),n.left&&(e.style.left=n.left),n.right&&(e.style.right=n.right),n.bottom&&(e.style.bottom=n.bottom);else{let d="",h=0;i&&(d=o.offsetTop+u.offsetTop,h=o.offsetLeft+o.offsetWidth-6),e.style.top=d+"px",e.style.left=h+"px"}e.style.display="block";let y=this.calcMenuWidth(a);e.style.width=y+")",e.style.minWidth=0,t.style.width=y+" - 2px)",e.style.height=this.calcMenuHeight(a)+"px",n||i&&(u.dataset.active=!0),e.focus(),this.openedMenu=e,document.addEventListener("keydown",this.boundMenuNavigationHandler)}closeMenu(a){let n=document.getElementById(a+"MenuBg"),e=!!n.dataset.openStandalone,t=!!n.dataset.submenuOf&&!e;if(t&&this.shouldNotCloseSubmenu)return;let i,o;if(!e&&t){i=document.getElementById(n.dataset.submenuOf+"MenuBg");let u=Array.from(i.querySelectorAll(".contextMenuItem")).findIndex(c=>c.dataset.submenu===a);o=i.querySelectorAll(".contextMenuItem")[u]}this.submenuCloseTimer&&clearTimeout(this.submenuCloseTimer),n.style.display="none",e?delete n.dataset.openStandalone:t&&delete o.dataset.active,n.dispatchEvent(this.afterMenuCloseEvent),t&&i.style.display!=="none"?(i.focus(),this.openedMenu=i):(this.openedMenu=null,document.removeEventListener("keydown",this.boundMenuNavigationHandler))}delayedCloseMenu(a){this.submenuCloseTimer=setTimeout(()=>{this.closeMenu(a)},300)}menuNavigationHandler(a){if(!this.openedMenu)return;let n;localStorage.wmpotifyDebugMode?n=this.openedMenu.querySelectorAll(".contextMenuItem"):n=this.openedMenu.querySelectorAll(".contextMenuItem:not(.debug)");let e=this.openedMenu.querySelector(".contextMenuItem[data-active]"),t=Array.from(n).indexOf(e),i;switch(this.openedMenu.dataset.submenuOf&&(i=document.getElementById(this.openedMenu.dataset.submenuOf+"MenuBg").querySelector(".contextMenuItem[data-active]")),this.handlingKeyEvent=!0,this.openedMenu.style.animation="none",a.key){case"Escape":this.mouseOverMenu=!1,this.openedMenu.blur();break;case"ArrowUp":e?(delete e.dataset.active,t>0?n[t-1].dataset.active=!0:n[n.length-1].dataset.active=!0):n[n.length-1].dataset.active=!0;break;case"ArrowDown":e?(delete e.dataset.active,t<n.length-1?n[t+1].dataset.active=!0:n[0].dataset.active=!0):n[0].dataset.active=!0;break;case"ArrowLeft":if(this.openedMenu.dataset.submenuOf){this.closeMenu(this.openedMenu.id.slice(0,-6),!0),i.dataset.active=!0;break}if(this.menuOrder.length===1)break;let o=this.menuOrder[(this.menuOrder.indexOf(this.openedMenu.id.slice(0,-6))+this.menuOrder.length-1)%this.menuOrder.length];this.closeMenu(this.openedMenu.id.slice(0,-6)),this.openMenu(o),this.openedMenu.querySelector(".contextMenuItem").dataset.active=!0;break;case"ArrowRight":if(e&&e.dataset.submenu){this.openMenu(e.dataset.submenu),this.openedMenu.querySelector(".contextMenuItem").dataset.active=!0;break}if(this.menuOrder.length===1)break;let u;this.openedMenu.dataset.submenuOf?(u=this.menuOrder[(this.menuOrder.indexOf(this.openedMenu.dataset.submenuOf)+1)%this.menuOrder.length],this.closeMenu(this.openedMenu.id.slice(0,-6))):(u=this.menuOrder[(this.menuOrder.indexOf(this.openedMenu.id.slice(0,-6))+1)%this.menuOrder.length],this.closeMenu(this.openedMenu.id.slice(0,-6))),this.openMenu(u),this.openedMenu.querySelector(".contextMenuItem").dataset.active=!0;break;case"Enter":if(e)e.click();else{this.openedMenu.blur();break}break;default:let c=this.openedMenu.getElementsByTagName("u");for(let s of c)if(a.key===s.textContent.toLowerCase()){s.parentElement.click();break}}this.handlingKeyEvent=!1,a.preventDefault(),a.stopPropagation()}calcMenuWidth(a){let n=document.getElementById(a+"MenuBg"),e;localStorage.wmpotifyDebugMode?e=n.querySelectorAll(".contextMenuItem:not([data-hidden])"):e=n.querySelectorAll(".contextMenuItem:not([data-hidden]):not(.debug)"),n.style.minWidth="";let t=parseInt(getComputedStyle(n).minWidth)||0;return`calc(${Array.from(e).reduce((o,u)=>{let c=u.textContent,s=$(c);return Math.max(t,o,s)},0)}px + 4.5em`}calcMenuHeight(a){let n=document.getElementById(a+"MenuBg"),e=n.querySelectorAll("hr"),t;localStorage.wmpotifyDebugMode?t=n.querySelectorAll(".contextMenuItem:not([data-hidden])"):t=n.querySelectorAll(".contextMenuItem:not([data-hidden]):not(.debug)");let i=t[0].offsetHeight,o=0;if(e.length>0){let c=getComputedStyle(e[0]);o=e[0].offsetHeight+parseFloat(c.marginTop)+parseFloat(c.marginBottom)}return parseInt(t.length*i+e.length*o)}};function k(l,a,n){let e=document.createElement("div");return e.id=l+"MenuBg",e.className="contextMenuBg",e.tabIndex=-1,e.style.display="none",e.innerHTML=`<div id="${l}Menu" class="contextMenu"></div>`,n&&(e.dataset.submenuOf=n),a.forEach(t=>{if(t.hr){let o=document.createElement("hr");e.querySelector(".contextMenu").appendChild(o);return}let i=document.createElement("div");i.className="contextMenuItem",t.args?i.innerHTML="<p>"+J(t.text,...t.args)+"</p>":i.innerHTML="<p>"+J(t.text)+"</p>",t.classList&&i.classList.add(...t.classList),t.disabled&&i.classList.add("disabled"),t.hidden&&(i.dataset.hidden=!0),t.submenu&&(i.dataset.submenu=t.submenu,i.innerHTML+='<p class="submenuMark">\u23F5</p>'),t.noClose&&(i.dataset.noClose=!0),i.addEventListener("click",t.click),e.querySelector(".contextMenu").appendChild(i)}),document.body.appendChild(e),{menuBg:e,menu:e.querySelector(".contextMenu"),menuItems:e.querySelectorAll(".contextMenuItem")}}function $(l,a=getComputedStyle(document.documentElement).getPropertyValue("--menu-font")){let e=($.canvas||($.canvas=document.createElement("canvas"))).getContext("2d");return e.font=a,e.measureText(l).width}function J(l){if(l=l.replace(/&([^&])/g,"<u>$1</u>").replace(/\\&/g,"&"),arguments.length>1)for(let a=1;a<arguments.length;a++)l=l.replace(/%s/,arguments[a]),l=l.replace(`%${a}s`,arguments[a]);return l}function T(l){let a=i=>{i&&(i._updateUiClient?.updateTitlebarHeight&&i._updateUiClient.updateTitlebarHeight({height:l||1}),i._updateUiClient?.setButtonsVisibility&&(!l||l<=1)&&i._updateUiClient.setButtonsVisibility(!1),window.addEventListener("beforeunload",()=>{i._updateUiClient?.setButtonsVisibility&&i._updateUiClient.setButtonsVisibility({showButtons:!0})})),Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:l?l+"px":"1px"})};a(Spicetify.Platform.ControlMessageAPI),a(Spicetify.Platform.UpdateAPI);async function n(){a(Spicetify.Platform.ControlMessageAPI),a(Spicetify.Platform.UpdateAPI)}let e=setInterval(n,100);setTimeout(()=>{clearInterval(e)},1e4);let t=()=>{a(Spicetify.Platform.ControlMessageAPI),a(Spicetify.Platform.UpdateAPI)};document.addEventListener("fullscreenchange",t)}function L(l){let a=Math.floor(l/1e3),n=Math.floor(a/60);if(a=String(a%60).padStart(2,"0"),n<60)return`${n}:${a}`;let e=Math.floor(n/60);return n=String(n%60).padStart(2,"0"),`${e}:${n}:${a}`}function F(){if(!document.querySelector("#queue-panel")||document.querySelector("#wmpotify-queue-toolbar")||document.querySelectorAll('div[data-encore-id="tabPanel"]').length>2)return;let l=document.querySelector("#Desktop_PanelContainer_Id"),a=document.querySelector("#Desktop_PanelContainer_Id > div > div:first-child > div:first-child"),n=document.querySelector("#Desktop_PanelContainer_Id > div > div:nth-child(2)"),e=document.createElement("div");e.id="wmpotify-queue-toolbar";let t=document.createElement("button");t.id="wmpotify-queue-playlist-button",t.classList.add("wmpotify-toolbar-button"),t.addEventListener("click",()=>{window.open(Spicetify.Player.data.context.uri)}),t.textContent=document.querySelector('#queue-panel div[data-flip-id*="section-header-"] a')?.textContent||"Now Playing",t.innerHTML+='<span class="expandMark">\u23F7</span>',e.appendChild(t);let i=document.createElement("button");i.id="wmpotify-queue-clear-button",i.classList.add("wmpotify-toolbar-button"),i.addEventListener("click",()=>{Spicetify.Platform.PlayerAPI.clearQueue(),Spicetify.Player.playUri("")}),e.appendChild(i),n.insertAdjacentElement("afterbegin",e);let o=document.createElement("div");o.id="wmpotify-queue-npv";let u=document.createElement("img");u.id="wmpotify-queue-album-art",u.src=document.querySelector(".main-nowPlayingWidget-coverArt .cover-art img")?.src||"",o.appendChild(u);let c=document.createElement("div");c.id="wmpotify-queue-song-title",c.textContent=document.querySelector(".main-trackInfo-name")?.textContent||"",o.appendChild(c),a.insertAdjacentElement("afterbegin",o),P(),new MutationObserver(P).observe(document.querySelectorAll("#queue-panel ul")[1],{childList:!0}),new MutationObserver(()=>{let b=document.querySelectorAll("#queue-panel ul")[1];b&&(P(),new MutationObserver(P).observe(b,{childList:!0}))}).observe(document.querySelector("#queue-panel"),{childList:!0});let s=document.querySelectorAll('#Desktop_PanelContainer_Id div[role="tablist"] button'),y=[],d;for(let b of s)y.push({text:b.textContent,click:function(){for(let S of d.menuItems)S.classList.remove("activeStyle");this.classList.add("activeStyle"),b.click()}});y[0].classList=["activeStyle"],document.querySelector("#wmpotifyQueueTabMenuBg")?.remove(),d=k("wmpotifyQueueTab",y);let h=new w(["wmpotifyQueueTab"]);l.addEventListener("contextmenu",b=>{b.preventDefault(),h.openMenu("wmpotifyQueueTab",{left:b.clientX+"px",top:b.clientY+"px"})}),Spicetify.Player.addEventListener("songchange",()=>{t.textContent=Spicetify.Player.data?.context?.metadata?.context_description||"Now Playing",t.innerHTML+='<span class="expandMark">\u23F7</span>',u.src=Spicetify.Player.data?.item?.album?.images?.[0]?.url?.replace("spotify:image:","https://i.scdn.co/image/")||"",c.textContent=Spicetify.Player.data?.item?.name||""})}function P(){if(!document.querySelector("#queue-panel")||!Spicetify.Queue)return;let l=document.querySelectorAll("#queue-panel li .HeaderArea");for(let a=0;a<l.length;a++){let n=l[a];if(n.querySelector(".wmpotify-queue-duration"))continue;let e=a===0?Spicetify.Queue.track?.contextTrack?.metadata?.duration:Spicetify.Queue.nextTracks?.[a-1]?.contextTrack?.metadata?.duration;if(!e)continue;let t=document.createElement("span");t.classList.add("wmpotify-queue-duration"),t.textContent=L(e),n.appendChild(t)}}(function(){let l=[".Root__globalNav",".main-globalNav-historyButtons",".main-globalNav-searchSection",".main-globalNav-searchContainer > button",".main-globalNav-searchContainer > div form button",".main-topBar-searchBar",'.custom-navlinks-scrollable_container div[role="presentation"] > button',".main-topBar-topbarContentRight > .main-actionButtons > button",".main-topBar-topbarContentRight > button:last-child",".player-controls__left",'.player-controls__buttons button[data-testid="control-button-skip-back"]','.player-controls__buttons button[data-testid="control-button-repeat"]','.player-controls__buttons button[data-testid="control-button-playpause"]',".player-controls__right",".playback-bar .encore-text",".volume-bar",".volume-bar__icon-button",".volume-bar .progress-bar",".main-nowPlayingBar-left",".main-nowPlayingWidget-trackInfo",".Root__right-sidebar > div > div"],a={"Your Library":"Library","Friend Activity":"Friends"};async function n(){switch(localStorage.wmpotifyShowLibX||(document.body.dataset.hideLibx=!0),localStorage.wmpotifyStyle){case"xp":case"aero":case"classic":break;case void 0:localStorage.wmpotifyStyle="xp";break;case"basic":document.hasFocus()?document.body.style.backgroundColor="var(--active-title)":document.body.style.backgroundColor="var(--inactive-title)",window.addEventListener("focus",()=>{document.body.style.backgroundColor="var(--active-title)"}),window.addEventListener("blur",()=>{document.body.style.backgroundColor="var(--inactive-title)"});break;default:document.body.style.backgroundColor=localStorage.wmpotifyStyle}document.documentElement.dataset.wmpotifyStyle=localStorage.wmpotifyStyle||"xp";let t="spotify";switch(localStorage.wmpotifyTitleStyle?t=localStorage.wmpotifyTitleStyle:window.outerHeight-window.innerHeight>0?t="native":window.SpotEx&&(t="custom"),document.documentElement.dataset.wmpotifyTitleStyle=t,t){case"native":T(0);break;case"custom":T(0);let r=document.createElement("div");if(r.id="wmpotify-title-buttons",window.SpotEx){let U=document.createElement("button");U.id="wmpotify-minimize-button",U.addEventListener("click",()=>{SpotEx.updateWindow({state:"minimized"})}),r.appendChild(U);let D=document.createElement("button");D.id="wmpotify-maximize-button",D.addEventListener("click",async()=>{await SpotEx.getWindow().state==="maximized"?SpotEx.updateWindow({state:"normal"}):SpotEx.updateWindow({state:"maximized"})}),r.appendChild(D)}let m=document.createElement("button");m.id="wmpotify-close-button",m.addEventListener("click",()=>{window.close()});case"spotify":let p=document.createElement("div");p.id="wmpotify-title-bar";let f=document.createElement("span");f.id="wmpotify-title-text",f.textContent=await Spicetify.AppTitle.get(),p.appendChild(f),t==="custom"?p.appendChild(r):T(25),document.body.appendChild(p);break}let i=document.querySelector(".Root__globalNav"),o=document.createElement("div");o.id="wmpotify-tabs-container",i.insertBefore(o,i.querySelector(".main-globalNav-searchSection"));let u=document.querySelector(".main-globalNav-searchContainer > button");B(u);let c=document.querySelector(".main-globalNav-searchContainer > div form button");B(c);let s=[u,c],y=document.querySelectorAll('.custom-navlinks-scrollable_container div[role="presentation"] > button');for(let r of y)B(r),s.push(r);let d=document.querySelectorAll(".main-topBar-topbarContentRight > .main-actionButtons > button");for(let r of d)B(r),s.push(r);let h=[];for(let r of s)h.push({text:r.querySelector(".wmpotify-tab-label").textContent,click:()=>r.click()});k("wmpotifyTab",h);let b=new w(["wmpotifyTab"]),S=document.createElement("button");S.id="wmpotify-tabs-overflow-button",S.addEventListener("click",()=>{b.openMenu("wmpotifyTab",{top:"0",left:S.getBoundingClientRect().left+"px"})}),o.appendChild(S),q(),setTimeout(q,1e3),window.addEventListener("resize",q);let z=document.querySelector(".main-topBar-topbarContentRight > button:last-child"),A=document.createElement("span");A.textContent=z.getAttribute("aria-label"),A.classList.add("wmpotify-user-label"),z.appendChild(A);let O=document.createElement("div");O.id="wmpotify-search-container";let x=document.createElement("div");x.id="wmpotify-search-wrapper";let _=document.querySelector(".main-topBar-searchBar");x.appendChild(_);let C=document.createElement("button");C.id="wmpotify-search-clear-button",C.setAttribute("aria-label","Clear search"),C.addEventListener("click",()=>{_.value="",_.focus(),window.open("spotify:search")}),x.appendChild(C),O.appendChild(x),i.appendChild(O);let H=document.querySelector(".player-controls__buttons button[data-testid='control-button-playpause']");Spicetify.Player.addEventListener("onplaypause",Q),new MutationObserver(Q).observe(H,{attributes:!0,attributeFilter:["aria-label"]}),X(),new MutationObserver(X).observe(document.querySelector(".main-nowPlayingBar-left"),{childList:!0});let v=document.querySelector(".player-controls__left"),V=document.querySelector('.player-controls__buttons button[data-testid="control-button-skip-back"]'),K=document.querySelector('.player-controls__buttons button[data-testid="control-button-repeat"]');v.insertBefore(K,V);let E=document.createElement("button");E.setAttribute("aria-label","Stop"),E.id="wmpotify-stop-button",E.addEventListener("click",()=>{Spicetify.Platform.PlayerAPI.clearQueue(),Spicetify.Player.playUri("")}),v.insertBefore(E,V);let Z=document.querySelector(".player-controls__right"),W=document.querySelector(".volume-bar"),I=W.querySelector(".volume-bar__icon-button"),j=W.querySelector(".progress-bar");Y(),new MutationObserver(Y).observe(j,{attributes:!0,attributeFilter:["style"]}),Z.appendChild(W);let N=document.querySelectorAll(".playback-bar .encore-text"),g=document.createElement("span");g.classList.add("wmpotify-time-text");let M=parseInt(localStorage.wmpotifyTimeTextMode||0);M===2&&(g.style.left="-80px"),G(),g.addEventListener("click",()=>{M=(M+1)%3,localStorage.wmpotifyTimeTextMode=M,M===2?g.style.left="-80px":g.style.left=""}),v.insertAdjacentElement("afterbegin",g),Spicetify.Player.addEventListener("onprogress",G);let R=new MutationObserver(()=>{let r=v.children.length;r!==4&&(R.disconnect(),v.insertBefore(v.children[r-2],K),R.observe(v,{childList:!0}))});R.observe(v,{childList:!0}),F(),new MutationObserver(F).observe(document.querySelector(".Root__right-sidebar > div > div"),{childList:!0});function B(r){o.appendChild(r);let m=document.createElement("span"),p=r.getAttribute("aria-label");m.textContent=a[p]||p,m.classList.add("wmpotify-tab-label"),r.appendChild(m)}function q(){let r=document.querySelector(".main-globalNav-historyButtons").getBoundingClientRect().right,m=window.innerWidth-document.querySelector(".main-topBar-topbarContentRight").getBoundingClientRect().left,p=160,f=0;for(;window.innerWidth-r-m-p<o.getBoundingClientRect().width&&f<s.length;)s[s.length-1-f++].dataset.hidden=!0;for(f=document.querySelectorAll("#wmpotify-tabs-container button[data-hidden]").length;f>0&&window.innerWidth-r-m-p>o.getBoundingClientRect().width;)delete s[s.length-f--].dataset.hidden;S.style.display=f>0?"block":""}globalThis.handleTabOverflow=q;function X(){Q();let r=document.querySelector(".main-nowPlayingWidget-trackInfo");if(!r||document.querySelector(".wmpotify-track-info"))return;let m=document.createElement("p");m.classList.add("wmpotify-track-info"),m.textContent=document.querySelector(".main-trackInfo-name")?.textContent||"",r.appendChild(m);let p=1;setInterval(()=>{if(!Spicetify.Player.isPlaying())return;let f=Spicetify.Player.data?.item.metadata;f&&(p===0?m.textContent=f.title:p===1?m.textContent=f.artist_name:p===2&&(m.textContent=f.album_title),p=(p+1)%3)},3e3),Spicetify.Player.addEventListener("songchange",()=>{p=0,m.textContent=Spicetify.Player.data?.item.metadata.title})}function Q(){Spicetify.Player.isPlaying()?H.classList.add("playing"):H.classList.remove("playing")}function Y(){let r=getComputedStyle(j).getPropertyValue("--progress-bar-transform").replace("%","")/100;r===0?I.dataset.vol="muted":r<=.3?I.dataset.vol="low":r<=.6?I.dataset.vol="mid":I.dataset.vol="high"}function G(){switch(M){case 0:let r=Spicetify.Player.data.item.metadata.duration-Spicetify.Player.getProgress();g.textContent=L(r);break;case 1:g.textContent=N[0].textContent;break;case 2:g.textContent=`${N[0].textContent} / ${N[1].textContent}`;break}}}function e(){return window.Spicetify&&window.Spicetify.CosmosAsync&&window.Spicetify.Platform?.PlayerAPI&&window.Spicetify.AppTitle&&window.Spicetify.Player?.origin?._state&&l.every(t=>document.querySelector(t))}window.addEventListener("load",()=>{let t=0,i=setInterval(()=>{if(e())n(),console.log("WMPotify: Theme loaded"),clearInterval(i);else if(t++>100){alert("[WMPotify] Theme loading failed. Please refresh the page to try again. Please make sure you have compatible Spoitfy version and have global navbar enabled."),clearInterval(i);let o=[];for(let u of l)document.querySelector(u)||o.push(u);console.log("WMPotify: Missing elements:",o)}},100)})})();})();
